<!DOCTYPE html>
<!-- saved from url=(0022)http://localhost:6592/ -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Karen Detter">
<meta name="dcterms.date" content="2023-05-25">

<title>Institutional Characteristics Analysis</title>
<style class="anchorjs"></style><style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="./MachineLearningAnalysisSpring2023_files/clipboard.min.js.download"></script>
<script src="./MachineLearningAnalysisSpring2023_files/quarto.js.download"></script>
<script src="./MachineLearningAnalysisSpring2023_files/popper.min.js.download"></script>
<script src="./MachineLearningAnalysisSpring2023_files/tippy.umd.min.js.download"></script>
<script src="./MachineLearningAnalysisSpring2023_files/anchor.min.js.download"></script>
<link href="./MachineLearningAnalysisSpring2023_files/tippy.css" rel="stylesheet">
<link href="./MachineLearningAnalysisSpring2023_files/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="./MachineLearningAnalysisSpring2023_files/bootstrap.min.js.download"></script>
<link href="./MachineLearningAnalysisSpring2023_files/bootstrap-icons.css" rel="stylesheet">
<link href="./MachineLearningAnalysisSpring2023_files/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="http://localhost:6592/#which-institutional-characteristics-can-predict-whether-undergraduate-students-graduate-on-time" id="toc-which-institutional-characteristics-can-predict-whether-undergraduate-students-graduate-on-time" class="nav-link" data-scroll-target="#which-institutional-characteristics-can-predict-whether-undergraduate-students-graduate-on-time">Which Institutional Characteristics Can Predict Whether Undergraduate Students Graduate On Time?</a>
  <ul class="">
  <li><a href="http://localhost:6592/#background" id="toc-background" class="nav-link" data-scroll-target="#background">1) Background</a></li>
  <li><a href="http://localhost:6592/#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">2) Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="http://localhost:6592/#a-description-of-variables" id="toc-a-description-of-variables" class="nav-link" data-scroll-target="#a-description-of-variables">a) Description of Variables</a></li>
  <li><a href="http://localhost:6592/#b-transformation-of-variables" id="toc-b-transformation-of-variables" class="nav-link" data-scroll-target="#b-transformation-of-variables">b) Transformation of Variables</a></li>
  </ul></li>
  <li><a href="http://localhost:6592/#evaluation-metric" id="toc-evaluation-metric" class="nav-link" data-scroll-target="#evaluation-metric">3) Evaluation Metric</a></li>
  <li><a href="http://localhost:6592/#data-preprocessing" id="toc-data-preprocessing" class="nav-link" data-scroll-target="#data-preprocessing">4) Data Preprocessing</a>
  <ul class="collapse">
  <li><a href="http://localhost:6592/#a-impute-na-values" id="toc-a-impute-na-values" class="nav-link" data-scroll-target="#a-impute-na-values">a) Impute NA values</a></li>
  </ul></li>
  <li><a href="http://localhost:6592/#fit-models" id="toc-fit-models" class="nav-link" data-scroll-target="#fit-models">5) Fit Models</a>
  <ul class="">
  <li><a href="http://localhost:6592/#a-lasso-regression" id="toc-a-lasso-regression" class="nav-link" data-scroll-target="#a-lasso-regression">a) Lasso Regression</a></li>
  <li><a href="http://localhost:6592/#b-random-forest-regression" id="toc-b-random-forest-regression" class="nav-link active" data-scroll-target="#b-random-forest-regression">b) Random Forest Regression</a></li>
  <li><a href="http://localhost:6592/#c-support-vector-regression" id="toc-c-support-vector-regression" class="nav-link" data-scroll-target="#c-support-vector-regression">c) Support Vector Regression</a></li>
  </ul></li>
  <li><a href="http://localhost:6592/#compare-models" id="toc-compare-models" class="nav-link" data-scroll-target="#compare-models">6) Compare Models</a>
  <ul class="collapse">
  <li><a href="http://localhost:6592/#a-evaluate-all-tuned-models-on-rmsle-with-test-data-set" id="toc-a-evaluate-all-tuned-models-on-rmsle-with-test-data-set" class="nav-link" data-scroll-target="#a-evaluate-all-tuned-models-on-rmsle-with-test-data-set">a) Evaluate all tuned models on RMSLE with test data set</a></li>
  </ul></li>
  <li><a href="http://localhost:6592/#ethical-implications" id="toc-ethical-implications" class="nav-link" data-scroll-target="#ethical-implications">7) Ethical Implications</a></li>
  <li><a href="http://localhost:6592/#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Institutional Characteristics Analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu" style=""><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Karen Detter </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 25, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="http://localhost:6592/#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lubridate' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="http://localhost:6592/#cb5-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="which-institutional-characteristics-can-predict-whether-undergraduate-students-graduate-on-time" class="level1">
<h1>Which Institutional Characteristics Can Predict Whether Undergraduate Students Graduate On Time?</h1>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">1) Background<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#background" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>Every fall, thousands of students enroll in undergraduate university programs with the expectation of obtaining a bachelor’s degree after four years of study. In reality, less than half of those students will graduate within the traditional four-year time frame. According to the latest figures from the <em>Education Data Initiative</em>, just 41% of students meet that goal (Medved, 2022). Because this increase in time to degree attainment points to potential failures in higher education systems, and also equates to inflated debt load on students, much investigation has been done into the reasons for this phenomenon (Marsh, 2014; Moore &amp; Shulock, 2009; Oseguera, 2005). Some research studies have positioned student-centric variables as the determinants of on-time graduation, implying that there is little to be done about the issue on the institutions’ end, outside of identifying and monitoring “at-risk” students. Others, however, have identified various institutional characteristics that have an impact on student ability to complete their degree programs in four years.</p>
<p>Recently, researchers have begun applying machine learning models to analyze this important issue. Two meta-analyses of these studies showed that these techniques showed promising results in accurately predicting the factors that have a significant impact on retention and completion variables (Attiya &amp; Shams, 2023; Cardona et al, 2020). A wide variety of methods were employed across the studies included in these reviews; however, most of them used their own institution-level data sets. In fact, both meta-studies identified more expansive data as a target for future research. This project, therefore, seeks to add to the current literature by applying machine learning algorithms to data from a national clearinghouse of university surveys in order to predict which institutional factors influence the amount of students who graduate within four years.</p>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">2) Exploratory Data Analysis<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#exploratory-data-analysis" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>The data used for the model is from the National Center for Education Statistics’ Data Center, a robust database containing thousands of data points self-reported annually by thousands of higher education institutions. Variables were selected according to those identified in the above-mentioned studies as being influential and filtered over US public and private (not-for-profit) 4-year degree-granting institutions. A custom data set was generated for information from the 2018-2019 school year. The resulting data set contains 1,803 observations for thirty variables.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="http://localhost:6592/#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  </span>
<span id="cb6-2"><a href="http://localhost:6592/#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)  </span>
<span id="cb6-3"><a href="http://localhost:6592/#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'caret' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'caret'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="http://localhost:6592/#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'glmnet' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Matrix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loaded glmnet 4.1-8</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="http://localhost:6592/#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'randomForest' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'randomForest'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    margin</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="http://localhost:6592/#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ranger' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ranger'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:randomForest':

    importance</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="http://localhost:6592/#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'e1071' was built under R version 4.3.3</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="http://localhost:6592/#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mltools) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'mltools' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mltools'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:e1071':

    skewness</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    replace_na</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="http://localhost:6592/#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="http://localhost:6592/#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caTools) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'caTools' was built under R version 4.3.3</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="http://localhost:6592/#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class) </span>
<span id="cb40-2"><a href="http://localhost:6592/#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'corrplot' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.92 loaded</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="http://localhost:6592/#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MLmetrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'MLmetrics' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MLmetrics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:caret':

    MAE, RMSE</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:base':

    Recall</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="http://localhost:6592/#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'mice' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mice'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    cbind, rbind</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="http://localhost:6592/#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'vip' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'vip'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:utils':

    vi</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="http://localhost:6592/#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load data set </span></span>
<span id="cb57-2"><a href="http://localhost:6592/#cb57-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/IPEDS_data.csv"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1803 Columns: 32
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (17): Name, MilCr, VetOrg, DualCr, LifeCr, APCr, ExpHrs, RemedSvcs, Acad...
dbl (15): ID, InstrExp, SuppExp, SvcsExp, Aid, AidAvg, OnTimeGrad, Select, C...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="http://localhost:6592/#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ID"         "Name"       "MilCr"      "VetOrg"     "DualCr"    
 [6] "LifeCr"     "APCr"       "ExpHrs"     "RemedSvcs"  "AcadCouns" 
[11] "Emp"        "PlSvcs"     "Daycare"    "Online"     "Library"   
[16] "LibRes"     "LibStaff"   "LibShare"   "InstrExp"   "SuppExp"   
[21] "SvcsExp"    "Aid"        "AidAvg"     "OnTimeGrad" "Select"    
[26] "Cost"       "Libs"       "Books"      "Serials"    "Ebooks"    
[31] "DB"         "Digital"   </code></pre>
</div>
</div>
<section id="a-description-of-variables" class="level3">
<h3 class="anchored" data-anchor-id="a-description-of-variables">a) Description of Variables<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#a-description-of-variables" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p>All variables (besides identifiers) are either dichotomous (yes/no) or continuous (% and $) and can be sorted across the following categories:</p>
<p><strong>Credits Allowed</strong> includes: <em>MilCr</em>-credit given for military service, <em>DualCr</em>-college credit can be earned in high school, <em>LifeCr</em>-credit given for life experience, <em>APCr</em>-Advanced Placement credits accepted</p>
<p><strong>Services Offered</strong> includes: <em>VetOrg</em>-veteran student organization available, <em>ExpHrs</em>-weekend/evening classes available, <em>RemedSvcs</em>-remedial services available, <em>AcadCouns</em>-academic counseling available, <em>Emp</em>-employment services for students available, <em>PlSvcs</em>-placement services for graduates available, <em>Daycare</em>- on-campus daycare services offered, <em>Online</em>-undergraduate distance learning offered, <em>Library</em>-physical library provided, <em>LibRes</em>-access to electronic resources provided, <em>LibStaff</em>-library staff available for consult, <em>LibShare</em>-access to other institutional libraries available, <em>Libs</em>-number of library branches, <em>Books</em>-as % of library collection, <em>Serials</em>-as % of library collection, <em>Ebooks</em>-as % of library collection, <em>DB</em>-databases as % of library collection, <em>Digital</em>-digital media as % of library collection</p>
<p><strong>Institutional Profile</strong> includes: <em>ID</em>-numeric identifier, <em>Name</em>, <em>Select</em>-% of applicants accepted</p>
<p><strong>Financial</strong> includes: <em>Cost</em>- total $ tuition &amp; fees, Aid-% of students receiving any form of tuition assistance, AidAvg-average $ amount of aid received per student, <em>InstrExp</em>- per-student $ expediture on instruction, <em>SuppExp</em>- per-student $ expenditure on student support services, <em>SvcsExp</em>- per-student $ expenditure on other student services</p>
<p><strong>Dependent Variable</strong>: <em>OnTimeGrad</em>- % of students who graduated with a bachelor’s degree in 4 years (as reported for 2019)</p>
</section>
<section id="b-transformation-of-variables" class="level3">
<h3 class="anchored" data-anchor-id="b-transformation-of-variables">b) Transformation of Variables<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#b-transformation-of-variables" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p>Because the data set was able to be customized directly from the database, not much wrangling is required. Some variables do, however, need to be transformed. Since this process will not substantively change the data values, it can be done on the full data set.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="http://localhost:6592/#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create binary variables for yes/no vectors  </span></span>
<span id="cb61-2"><a href="http://localhost:6592/#cb61-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">MilCr =</span> <span class="fu">case_when</span>(     MilCr <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     MilCr <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb61-3"><a href="http://localhost:6592/#cb61-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">VetOrg =</span> <span class="fu">case_when</span>(     VetOrg <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     VetOrg <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb61-4"><a href="http://localhost:6592/#cb61-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">DualCr =</span> <span class="fu">case_when</span>(     DualCr <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     DualCr <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb61-5"><a href="http://localhost:6592/#cb61-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">LifeCr =</span> <span class="fu">case_when</span>(     LifeCr <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     LifeCr <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb61-6"><a href="http://localhost:6592/#cb61-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">APCr =</span> <span class="fu">case_when</span>(     APCr <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     APCr <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb61-7"><a href="http://localhost:6592/#cb61-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">ExpHrs =</span> <span class="fu">case_when</span>(     ExpHrs <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     ExpHrs <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb61-8"><a href="http://localhost:6592/#cb61-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">RemedSvcs =</span> <span class="fu">case_when</span>(     RemedSvcs <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     RemedSvcs <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb61-9"><a href="http://localhost:6592/#cb61-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">AcadCouns =</span> <span class="fu">case_when</span>(     AcadCouns <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     AcadCouns <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb61-10"><a href="http://localhost:6592/#cb61-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">Emp =</span> <span class="fu">case_when</span>(     Emp <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     Emp <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb61-11"><a href="http://localhost:6592/#cb61-11" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">PlSvcs =</span> <span class="fu">case_when</span>(     PlSvcs <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     PlSvcs <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb61-12"><a href="http://localhost:6592/#cb61-12" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">Daycare =</span> <span class="fu">case_when</span>(     Daycare <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     Daycare <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb61-13"><a href="http://localhost:6592/#cb61-13" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">Online =</span> <span class="fu">case_when</span>(     Online <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     Online <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb61-14"><a href="http://localhost:6592/#cb61-14" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">Library =</span> <span class="fu">case_when</span>(     Library <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     Library <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb61-15"><a href="http://localhost:6592/#cb61-15" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">LibRes =</span> <span class="fu">case_when</span>(     LibRes <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     LibRes <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb61-16"><a href="http://localhost:6592/#cb61-16" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">LibStaff =</span> <span class="fu">case_when</span>(     LibStaff <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     LibStaff <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb61-17"><a href="http://localhost:6592/#cb61-17" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">LibShare =</span> <span class="fu">case_when</span>(     LibShare <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     LibShare <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="http://localhost:6592/#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#examine cleaned data </span></span>
<span id="cb62-2"><a href="http://localhost:6592/#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       ID             Name               MilCr            VetOrg      
 Min.   :100654   Length:1803        Min.   :0.0000   Min.   :0.0000  
 1st Qu.:154138   Class :character   1st Qu.:0.0000   1st Qu.:0.0000  
 Median :190567   Mode  :character   Median :1.0000   Median :0.0000  
 Mean   :207470                      Mean   :0.6972   Mean   :0.4322  
 3rd Qu.:219064                      3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :497213                      Max.   :1.0000   Max.   :1.0000  
                                     NA's   :10       NA's   :10      
     DualCr         LifeCr            APCr            ExpHrs      
 Min.   :0.00   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:1.00   1st Qu.:0.0000   1st Qu.:1.0000   1st Qu.:0.0000  
 Median :1.00   Median :0.0000   Median :1.0000   Median :0.0000  
 Mean   :0.85   Mean   :0.4796   Mean   :0.9202   Mean   :0.4222  
 3rd Qu.:1.00   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :1.00   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
 NA's   :10     NA's   :10       NA's   :10       NA's   :10      
   RemedSvcs        AcadCouns           Emp             PlSvcs      
 Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.0000   1st Qu.:1.0000   1st Qu.:1.0000   1st Qu.:1.0000  
 Median :1.0000   Median :1.0000   Median :1.0000   Median :1.0000  
 Mean   :0.6202   Mean   :0.9888   Mean   :0.8684   Mean   :0.7736  
 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
 NA's   :10       NA's   :10       NA's   :10       NA's   :10      
    Daycare           Online          Library           LibRes     
 Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.000  
 1st Qu.:0.0000   1st Qu.:1.0000   1st Qu.:1.0000   1st Qu.:1.000  
 Median :0.0000   Median :1.0000   Median :1.0000   Median :1.000  
 Mean   :0.2153   Mean   :0.8139   Mean   :0.9716   Mean   :0.966  
 3rd Qu.:0.0000   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.000  
 Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.000  
 NA's   :10       NA's   :14       NA's   :10       NA's   :10     
    LibStaff         LibShare        InstrExp         SuppExp     
 Min.   :0.0000   Min.   :0.000   Min.   :     0   Min.   :  429  
 1st Qu.:1.0000   1st Qu.:1.000   1st Qu.:  7239   1st Qu.: 1704  
 Median :1.0000   Median :1.000   Median :  9225   Median : 2412  
 Mean   :0.9632   Mean   :0.937   Mean   : 12244   Mean   : 3433  
 3rd Qu.:1.0000   3rd Qu.:1.000   3rd Qu.: 12000   3rd Qu.: 3428  
 Max.   :1.0000   Max.   :1.000   Max.   :171547   Max.   :54666  
 NA's   :10       NA's   :10      NA's   :1249     NA's   :1249   
    SvcsExp           Aid             AidAvg        OnTimeGrad    
 Min.   :  183   Min.   :  0.00   Min.   :  926   Min.   :  0.00  
 1st Qu.: 1456   1st Qu.: 63.00   1st Qu.: 7442   1st Qu.: 24.00  
 Median : 2099   Median : 79.00   Median :11450   Median : 40.00  
 Mean   : 2451   Mean   : 75.52   Mean   :15001   Mean   : 40.91  
 3rd Qu.: 3015   3rd Qu.: 92.00   3rd Qu.:20633   3rd Qu.: 57.00  
 Max.   :29888   Max.   :100.00   Max.   :54176   Max.   :100.00  
 NA's   :1249    NA's   :21       NA's   :29      NA's   :142     
     Select            Cost            Libs            Books       
 Min.   :  2.00   Min.   :  480   Min.   : 0.000   Min.   :  0.00  
 1st Qu.: 57.00   1st Qu.: 9798   1st Qu.: 0.000   1st Qu.: 16.00  
 Median : 71.00   Median :19407   Median : 0.000   Median : 30.00  
 Mean   : 68.01   Mean   :23280   Mean   : 1.109   Mean   : 36.53  
 3rd Qu.: 83.00   3rd Qu.:34298   3rd Qu.: 1.000   3rd Qu.: 49.00  
 Max.   :100.00   Max.   :59430   Max.   :33.000   Max.   :100.00  
 NA's   :256      NA's   :101     NA's   :249      NA's   :18      
    Serials            Ebooks             DB              Digital      
 Min.   : 0.0000   Min.   :  0.00   Min.   :  0.0000   Min.   : 0.000  
 1st Qu.: 0.0000   1st Qu.: 18.00   1st Qu.:  0.0000   1st Qu.: 0.000  
 Median : 0.0000   Median : 41.00   Median :  0.0000   Median : 3.000  
 Mean   : 0.7658   Mean   : 39.48   Mean   :  0.3176   Mean   : 7.925  
 3rd Qu.: 1.0000   3rd Qu.: 59.00   3rd Qu.:  0.0000   3rd Qu.:10.000  
 Max.   :62.0000   Max.   :100.00   Max.   :100.0000   Max.   :97.000  
 NA's   :18        NA's   :18       NA's   :18         NA's   :18      </code></pre>
</div>
</div>
<p>An examination of the variable ranges shows a few large outlier values (within the expenditures variables), but the mean, median, and quartile measures indicate that distribution should be reasonably normal. The expenditures variables also have a large amount of <em>NA</em> values that will need to be imputed, which theoretically could substantially change the evaluation and applicability of the model. The missing values are likely due to unavailability of data, so imputation is the only option because expenditures are intuitively important variables to be included in the predictive models.</p>
<p>The data is now ready to be split. Because the data set is somewhat small, the training set will be set to 70% and the test set to 30%, to ensure that both sets are sufficiently representative of the data.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="http://localhost:6592/#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#split into training and test sets  </span></span>
<span id="cb64-2"><a href="http://localhost:6592/#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb64-3"><a href="http://localhost:6592/#cb64-3" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">size =</span> <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">7</span>, .<span class="dv">3</span>)) </span>
<span id="cb64-4"><a href="http://localhost:6592/#cb64-4" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> data[idx <span class="sc">==</span> <span class="dv">1</span>,] </span>
<span id="cb64-5"><a href="http://localhost:6592/#cb64-5" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> data[idx <span class="sc">==</span> <span class="dv">2</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="evaluation-metric" class="level2">
<h2 class="anchored" data-anchor-id="evaluation-metric">3) Evaluation Metric<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#evaluation-metric" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>Because the variable of interest, the percentage of students who graduate in four years, is continuous, and the problem to be addressed is one of prediction, regression methods will be the most appropriate models. As such, the metric used in k-fold cross validation to compare model performance will be Root Mean Squared Error. RMSE is a common metric for evaluating regression models, and is a readily available calculation in many R packages. It is a simple computation that measures the average difference between predicted and actual values, making it easy to explain.</p>
<p>RMSLE is likely a more appropriate metric for this data set, as it is neither scale-dependent nor sensitive to outliers. However, it is not readily available as a metric in any well-known R packages with cross validation functions, and customizing the metric would require extensive time and effort, whereas RMSE is an acceptable default metric. As such, as a compromise between precision and efficiency, it will be used to compare performance across models after parameter tuning has been completed.</p>
</section>
<section id="data-preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="data-preprocessing">4) Data Preprocessing<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#data-preprocessing" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<section id="a-impute-na-values" class="level3">
<h3 class="anchored" data-anchor-id="a-impute-na-values">a) Impute NA values<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#a-impute-na-values" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p>There are many missing values in the expenditure variable vectors, so these will be imputed using the multiple imputation method of predictive mean matching.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="http://localhost:6592/#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#subset training without character variables  </span></span>
<span id="cb65-2"><a href="http://localhost:6592/#cb65-2" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> <span class="fu">subset</span>(training, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(ID,Name)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="http://localhost:6592/#cb66-1" aria-hidden="true" tabindex="-1"></a>init <span class="ot">=</span> <span class="fu">mice</span>(training, <span class="at">maxit=</span><span class="dv">0</span>)</span>
<span id="cb66-2"><a href="http://localhost:6592/#cb66-2" aria-hidden="true" tabindex="-1"></a>meth <span class="ot">=</span> init<span class="sc">$</span>method</span>
<span id="cb66-3"><a href="http://localhost:6592/#cb66-3" aria-hidden="true" tabindex="-1"></a>predM<span class="ot">=</span>init<span class="sc">$</span>predictorMatrix</span>
<span id="cb66-4"><a href="http://localhost:6592/#cb66-4" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"InstrExp"</span>)]<span class="ot">=</span><span class="st">'pmm'</span></span>
<span id="cb66-5"><a href="http://localhost:6592/#cb66-5" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"SuppExp"</span>)]<span class="ot">=</span><span class="st">'pmm'</span></span>
<span id="cb66-6"><a href="http://localhost:6592/#cb66-6" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"SvcsExp"</span>)]<span class="ot">=</span><span class="st">'pmm'</span></span>
<span id="cb66-7"><a href="http://localhost:6592/#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb66-8"><a href="http://localhost:6592/#cb66-8" aria-hidden="true" tabindex="-1"></a>imputed <span class="ot">=</span> <span class="fu">mice</span>(training, <span class="at">method=</span>meth, <span class="at">predictorMatrix=</span>predM, <span class="at">m=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  1   2  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  1   3  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  1   4  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  1   5  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  2   1  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  2   2  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  2   3  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  2   4  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  2   5  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  3   1  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  3   2  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  3   3  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  3   4  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  3   5  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  4   1  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  4   2  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  4   3  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  4   4  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  4   5  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  5   1  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  5   2  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  5   3  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  5   4  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  5   5  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 75</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="http://localhost:6592/#cb69-1" aria-hidden="true" tabindex="-1"></a>imputed_training <span class="ot">&lt;-</span> <span class="fu">complete</span>(imputed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="http://localhost:6592/#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(imputed_training, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     MilCr     VetOrg     DualCr     LifeCr       APCr     ExpHrs  RemedSvcs 
         0          0          0          0          0          0          0 
 AcadCouns        Emp     PlSvcs    Daycare     Online    Library     LibRes 
         0          0          0          0          0          0          0 
  LibStaff   LibShare   InstrExp    SuppExp    SvcsExp        Aid     AidAvg 
         0          0          0          0          0          0          0 
OnTimeGrad     Select       Cost       Libs      Books    Serials     Ebooks 
         0          0          0          0          0          0          0 
        DB    Digital 
         0          0 </code></pre>
</div>
</div>
<p>Since all of the data vectors have been imputed with predicted estimated values, the new training set is ready to be used for model fitting.</p>
</section>
</section>
<section id="fit-models" class="level2">
<h2 class="anchored" data-anchor-id="fit-models">5) Fit Models<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#fit-models" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>Based on their performance in previous research studies, lasso, random forest, and support vector regression models will be built. The properties of these three methods make them appropriate for data sets with a large number of variables and potential outliers.</p>
<p>As a first step, relationships among variables are assessed visually.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="http://localhost:6592/#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#assess multicollinearity </span></span>
<span id="cb72-2"><a href="http://localhost:6592/#cb72-2" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fu">cor</span>(imputed_training) </span>
<span id="cb72-3"><a href="http://localhost:6592/#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(c)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./MachineLearningAnalysisSpring2023_files/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It appears that <em>Cost</em> &amp; <em>AidAvg</em> and <em>Book</em>s &amp; <em>Ebooks</em> may be collinear, but not necessarily to a great enough degree to remove the variables, as they are likely still important to the model.</p>
<section id="a-lasso-regression" class="level3">
<h3 class="anchored" data-anchor-id="a-lasso-regression">a) Lasso Regression<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#a-lasso-regression" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="http://localhost:6592/#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create outcome variable object</span></span>
<span id="cb73-2"><a href="http://localhost:6592/#cb73-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> imputed_training<span class="sc">$</span>OnTimeGrad</span>
<span id="cb73-3"><a href="http://localhost:6592/#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="http://localhost:6592/#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co">#create predictor variables object</span></span>
<span id="cb73-5"><a href="http://localhost:6592/#cb73-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(OnTimeGrad<span class="sc">~</span>., imputed_training)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb73-6"><a href="http://localhost:6592/#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="http://localhost:6592/#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co">#find the best value for lambda using cross-validation</span></span>
<span id="cb73-8"><a href="http://localhost:6592/#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb73-9"><a href="http://localhost:6592/#cb73-9" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x,y,<span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb73-10"><a href="http://localhost:6592/#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="http://localhost:6592/#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="co">#fit model</span></span>
<span id="cb73-12"><a href="http://localhost:6592/#cb73-12" aria-hidden="true" tabindex="-1"></a>LR <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">1</span>, <span class="at">lambda=</span>cv<span class="sc">$</span>lambda.min)</span>
<span id="cb73-13"><a href="http://localhost:6592/#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(LR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glmnet(x = x, y = y, alpha = 1, lambda = cv$lambda.min) 

  Df  %Dev Lambda
1 25 59.46 0.1779</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="http://localhost:6592/#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#k-fold cross validation  </span></span>
<span id="cb75-2"><a href="http://localhost:6592/#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="http://localhost:6592/#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co">#define training control </span></span>
<span id="cb75-4"><a href="http://localhost:6592/#cb75-4" aria-hidden="true" tabindex="-1"></a>control <span class="ot">=</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>,                      </span>
<span id="cb75-5"><a href="http://localhost:6592/#cb75-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">number =</span> <span class="dv">10</span>)  </span>
<span id="cb75-6"><a href="http://localhost:6592/#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co">#train model  </span></span>
<span id="cb75-7"><a href="http://localhost:6592/#cb75-7" aria-hidden="true" tabindex="-1"></a>LRmodel <span class="ot">&lt;-</span> <span class="fu">train</span>(OnTimeGrad <span class="sc">~</span> ., <span class="at">data =</span> imputed_training, <span class="at">method =</span> <span class="st">"glmnet"</span>,    <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> .<span class="dv">1779</span>), <span class="at">trControl =</span> control, <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">'scale'</span>))</span>
<span id="cb75-8"><a href="http://localhost:6592/#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(LRmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>glmnet 

1262 samples
  29 predictor

Pre-processing: scaled (29) 
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1137, 1136, 1136, 1135, 1137, 1136, ... 
Resampling results:

  RMSE      Rsquared   MAE     
  14.85712  0.5769419  11.29723

Tuning parameter 'alpha' was held constant at a value of 1
Tuning
 parameter 'lambda' was held constant at a value of 0.1779</code></pre>
</div>
</div>
</section>
<section id="b-random-forest-regression" class="level3">
<h3 class="anchored" data-anchor-id="b-random-forest-regression">b) Random Forest Regression<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#b-random-forest-regression" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="http://localhost:6592/#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fit model </span></span>
<span id="cb77-2"><a href="http://localhost:6592/#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb77-3"><a href="http://localhost:6592/#cb77-3" aria-hidden="true" tabindex="-1"></a>RFmodel <span class="ot">=</span> <span class="fu">ranger</span>(</span>
<span id="cb77-4"><a href="http://localhost:6592/#cb77-4" aria-hidden="true" tabindex="-1"></a>  OnTimeGrad <span class="sc">~</span> .,</span>
<span id="cb77-5"><a href="http://localhost:6592/#cb77-5" aria-hidden="true" tabindex="-1"></a>  imputed_training,</span>
<span id="cb77-6"><a href="http://localhost:6592/#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">importance =</span> <span class="st">'permutation'</span>,</span>
<span id="cb77-7"><a href="http://localhost:6592/#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">num.trees =</span> <span class="dv">1000</span>)</span>
<span id="cb77-8"><a href="http://localhost:6592/#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="http://localhost:6592/#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(RFmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Ranger result

Call:
 ranger(OnTimeGrad ~ ., imputed_training, importance = "permutation",      num.trees = 1000) 

Type:                             Regression 
Number of trees:                  1000 
Sample size:                      1262 
Number of independent variables:  29 
Mtry:                             5 
Target node size:                 5 
Variable importance mode:         permutation 
Splitrule:                        variance 
OOB prediction error (MSE):       215.955 
R squared (OOB):                  0.5855758 </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="http://localhost:6592/#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#k-fold cross validation  </span></span>
<span id="cb79-2"><a href="http://localhost:6592/#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="http://localhost:6592/#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co">#define training control </span></span>
<span id="cb79-4"><a href="http://localhost:6592/#cb79-4" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">'repeatedcv'</span>, </span>
<span id="cb79-5"><a href="http://localhost:6592/#cb79-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">number=</span><span class="dv">10</span>, </span>
<span id="cb79-6"><a href="http://localhost:6592/#cb79-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">repeats=</span><span class="dv">3</span>, </span>
<span id="cb79-7"><a href="http://localhost:6592/#cb79-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">search=</span><span class="st">'grid'</span>)</span>
<span id="cb79-8"><a href="http://localhost:6592/#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="http://localhost:6592/#cb79-9" aria-hidden="true" tabindex="-1"></a>tunegrid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb79-10"><a href="http://localhost:6592/#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,</span>
<span id="cb79-11"><a href="http://localhost:6592/#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">splitrule =</span> <span class="st">"variance"</span>,</span>
<span id="cb79-12"><a href="http://localhost:6592/#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">min.node.size =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb79-13"><a href="http://localhost:6592/#cb79-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-14"><a href="http://localhost:6592/#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="http://localhost:6592/#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="co">#train model  </span></span>
<span id="cb79-16"><a href="http://localhost:6592/#cb79-16" aria-hidden="true" tabindex="-1"></a>RF <span class="ot">&lt;-</span> <span class="fu">train</span>( OnTimeGrad <span class="sc">~</span>., </span>
<span id="cb79-17"><a href="http://localhost:6592/#cb79-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> imputed_training,</span>
<span id="cb79-18"><a href="http://localhost:6592/#cb79-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">'ranger'</span>,</span>
<span id="cb79-19"><a href="http://localhost:6592/#cb79-19" aria-hidden="true" tabindex="-1"></a>                       <span class="at">metric =</span> <span class="st">'RMSE'</span>,</span>
<span id="cb79-20"><a href="http://localhost:6592/#cb79-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tuneGrid =</span> tunegrid)</span>
<span id="cb79-21"><a href="http://localhost:6592/#cb79-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(RF)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest 

1262 samples
  29 predictor

No pre-processing
Resampling: Bootstrapped (25 reps) 
Summary of sample sizes: 1262, 1262, 1262, 1262, 1262, 1262, ... 
Resampling results across tuning parameters:

  mtry  min.node.size  RMSE      Rsquared   MAE     
   1    10             17.01898  0.5402328  13.90552
   1    20             17.04621  0.5406750  13.93342
   2    10             15.28780  0.5652520  11.94324
   2    20             15.35038  0.5648569  12.02916
   3    10             14.98063  0.5708326  11.48078
   3    20             15.01846  0.5703248  11.54652
   4    10             14.90852  0.5713954  11.32574
   4    20             14.92582  0.5714703  11.37500
   5    10             14.87336  0.5721183  11.24376
   5    20             14.90014  0.5712284  11.29604
   6    10             14.87827  0.5709746  11.21353
   6    20             14.90308  0.5698597  11.25701
   7    10             14.88998  0.5698367  11.18873
   7    20             14.90415  0.5693225  11.22127
   8    10             14.91609  0.5678535  11.19488
   8    20             14.93227  0.5672413  11.22062
   9    10             14.93605  0.5665591  11.19424
   9    20             14.94038  0.5665291  11.21060
  10    10             14.94857  0.5658145  11.18964
  10    20             14.95922  0.5652691  11.21101
  11    10             14.97931  0.5638042  11.19581
  11    20             14.98226  0.5637829  11.21229
  12    10             14.97770  0.5639536  11.19659
  12    20             14.99939  0.5627409  11.21509
  13    10             15.00062  0.5625611  11.19796
  13    20             15.00197  0.5625045  11.20538
  14    10             15.03348  0.5605781  11.21749
  14    20             15.03621  0.5604985  11.22970
  15    10             15.03859  0.5602733  11.21257
  15    20             15.03630  0.5603961  11.22601

Tuning parameter 'splitrule' was held constant at a value of variance
RMSE was used to select the optimal model using the smallest value.
The final values used for the model were mtry = 5, splitrule = variance
 and min.node.size = 10.</code></pre>
</div>
</div>
</section>
<section id="c-support-vector-regression" class="level3">
<h3 class="anchored" data-anchor-id="c-support-vector-regression">c) Support Vector Regression<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#c-support-vector-regression" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="http://localhost:6592/#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fit model with training data  </span></span>
<span id="cb81-2"><a href="http://localhost:6592/#cb81-2" aria-hidden="true" tabindex="-1"></a>SVmodel <span class="ot">&lt;-</span> <span class="fu">svm</span>(OnTimeGrad <span class="sc">~</span> ., <span class="at">data=</span>imputed_training)</span>
<span id="cb81-3"><a href="http://localhost:6592/#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(SVmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm(formula = OnTimeGrad ~ ., data = imputed_training)


Parameters:
   SVM-Type:  eps-regression 
 SVM-Kernel:  radial 
       cost:  1 
      gamma:  0.03448276 
    epsilon:  0.1 


Number of Support Vectors:  1076</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="http://localhost:6592/#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cross validation   </span></span>
<span id="cb83-2"><a href="http://localhost:6592/#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb83-3"><a href="http://localhost:6592/#cb83-3" aria-hidden="true" tabindex="-1"></a>SV <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb83-4"><a href="http://localhost:6592/#cb83-4" aria-hidden="true" tabindex="-1"></a>  OnTimeGrad <span class="sc">~</span>., <span class="at">data =</span> imputed_training, <span class="at">method =</span> <span class="st">"svmLinear2"</span>,</span>
<span id="cb83-5"><a href="http://localhost:6592/#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb83-6"><a href="http://localhost:6592/#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">cost =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">20</span>)),</span>
<span id="cb83-7"><a href="http://localhost:6592/#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"scale"</span>)</span>
<span id="cb83-8"><a href="http://localhost:6592/#cb83-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: model fit failed for Fold01: cost=0.0000 Error in svm.default(x = as.matrix(x), y = y, kernel = "linear", cost = param$cost,  : 
  C &lt;= 0!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: model fit failed for Fold02: cost=0.0000 Error in svm.default(x = as.matrix(x), y = y, kernel = "linear", cost = param$cost,  : 
  C &lt;= 0!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: model fit failed for Fold03: cost=0.0000 Error in svm.default(x = as.matrix(x), y = y, kernel = "linear", cost = param$cost,  : 
  C &lt;= 0!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: model fit failed for Fold04: cost=0.0000 Error in svm.default(x = as.matrix(x), y = y, kernel = "linear", cost = param$cost,  : 
  C &lt;= 0!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: model fit failed for Fold05: cost=0.0000 Error in svm.default(x = as.matrix(x), y = y, kernel = "linear", cost = param$cost,  : 
  C &lt;= 0!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: model fit failed for Fold06: cost=0.0000 Error in svm.default(x = as.matrix(x), y = y, kernel = "linear", cost = param$cost,  : 
  C &lt;= 0!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: model fit failed for Fold07: cost=0.0000 Error in svm.default(x = as.matrix(x), y = y, kernel = "linear", cost = param$cost,  : 
  C &lt;= 0!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: model fit failed for Fold08: cost=0.0000 Error in svm.default(x = as.matrix(x), y = y, kernel = "linear", cost = param$cost,  : 
  C &lt;= 0!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: model fit failed for Fold09: cost=0.0000 Error in svm.default(x = as.matrix(x), y = y, kernel = "linear", cost = param$cost,  : 
  C &lt;= 0!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: model fit failed for Fold10: cost=0.0000 Error in svm.default(x = as.matrix(x), y = y, kernel = "linear", cost = param$cost,  : 
  C &lt;= 0!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nominalTrainWorkflow(x = x, y = y, wts = weights, info = trainInfo,
: There were missing values in resampled performance measures.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in train.default(x, y, weights = w, ...): missing values found in
aggregated results</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="http://localhost:6592/#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot model accuracy vs different values of Cost</span></span>
<span id="cb96-2"><a href="http://localhost:6592/#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(SV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./MachineLearningAnalysisSpring2023_files/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="http://localhost:6592/#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the best tuning parameter C that</span></span>
<span id="cb97-2"><a href="http://localhost:6592/#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co"># maximizes model accuracy</span></span>
<span id="cb97-3"><a href="http://localhost:6592/#cb97-3" aria-hidden="true" tabindex="-1"></a>SV<span class="sc">$</span>bestTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       cost
2 0.1052632</code></pre>
</div>
</div>
</section>
</section>
<section id="compare-models" class="level2">
<h2 class="anchored" data-anchor-id="compare-models">6) Compare Models<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#compare-models" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>The RMSE values for the models as fitted are 14.85 for lasso regression, 14.87 for random forest regression, and 15.10 for support vector regression. To make a final evaluation of which model is most accurate, the tuned models will be compared on the more appropriate metric of RMSLE.</p>
<section id="a-evaluate-all-tuned-models-on-rmsle-with-test-data-set" class="level3">
<h3 class="anchored" data-anchor-id="a-evaluate-all-tuned-models-on-rmsle-with-test-data-set">a) Evaluate all tuned models on RMSLE with test data set<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#a-evaluate-all-tuned-models-on-rmsle-with-test-data-set" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="http://localhost:6592/#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data preprocessing of test set</span></span>
<span id="cb99-2"><a href="http://localhost:6592/#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="http://localhost:6592/#cb99-3" aria-hidden="true" tabindex="-1"></a>init <span class="ot">=</span> <span class="fu">mice</span>(test, <span class="at">maxit=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 1</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="http://localhost:6592/#cb101-1" aria-hidden="true" tabindex="-1"></a>meth <span class="ot">=</span> init<span class="sc">$</span>method</span>
<span id="cb101-2"><a href="http://localhost:6592/#cb101-2" aria-hidden="true" tabindex="-1"></a>predM<span class="ot">=</span>init<span class="sc">$</span>predictorMatrix</span>
<span id="cb101-3"><a href="http://localhost:6592/#cb101-3" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"InstrExp"</span>)]<span class="ot">=</span><span class="st">'pmm'</span></span>
<span id="cb101-4"><a href="http://localhost:6592/#cb101-4" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"SuppExp"</span>)]<span class="ot">=</span><span class="st">'pmm'</span></span>
<span id="cb101-5"><a href="http://localhost:6592/#cb101-5" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"SvcsExp"</span>)]<span class="ot">=</span><span class="st">'pmm'</span></span>
<span id="cb101-6"><a href="http://localhost:6592/#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb101-7"><a href="http://localhost:6592/#cb101-7" aria-hidden="true" tabindex="-1"></a>imputed2 <span class="ot">=</span> <span class="fu">mice</span>(test, <span class="at">method=</span>meth, <span class="at">predictorMatrix=</span>predM, <span class="at">m=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  1   2  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  1   3  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  1   4  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  1   5  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  2   1  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  2   2  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  2   3  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  2   4  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  2   5  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  3   1  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  3   2  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  3   3  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  3   4  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  3   5  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  4   1  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  4   2  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  4   3  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  4   4  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  4   5  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  5   1  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  5   2  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  5   3  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  5   4  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital
  5   5  MilCr  VetOrg  DualCr  LifeCr  APCr  ExpHrs  RemedSvcs  AcadCouns  Emp  PlSvcs  Daycare  Online  Library  LibRes  LibStaff  LibShare  InstrExp  SuppExp  SvcsExp  Aid  AidAvg  OnTimeGrad  Select  Cost  Libs  Books  Serials  Ebooks  DB  Digital</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 100</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="http://localhost:6592/#cb104-1" aria-hidden="true" tabindex="-1"></a>imputed_test <span class="ot">&lt;-</span> <span class="fu">complete</span>(imputed2)</span>
<span id="cb104-2"><a href="http://localhost:6592/#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(imputed_test, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        ID       Name      MilCr     VetOrg     DualCr     LifeCr       APCr 
         0          0          0          0          0          0          0 
    ExpHrs  RemedSvcs  AcadCouns        Emp     PlSvcs    Daycare     Online 
         0          0          0          0          0          0          0 
   Library     LibRes   LibStaff   LibShare   InstrExp    SuppExp    SvcsExp 
         0          0          0          0          0          0          0 
       Aid     AidAvg OnTimeGrad     Select       Cost       Libs      Books 
         0          0          0          0          0          0          0 
   Serials     Ebooks         DB    Digital 
         0          0          0          0 </code></pre>
</div>
</div>
<section id="i-lasso-regression" class="level4">
<h4 class="anchored" data-anchor-id="i-lasso-regression">i) Lasso Regression<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#i-lasso-regression" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="http://localhost:6592/#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create outcome variable object</span></span>
<span id="cb106-2"><a href="http://localhost:6592/#cb106-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> imputed_test<span class="sc">$</span>OnTimeGrad</span>
<span id="cb106-3"><a href="http://localhost:6592/#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="http://localhost:6592/#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co">#create predictor variables object</span></span>
<span id="cb106-5"><a href="http://localhost:6592/#cb106-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(OnTimeGrad<span class="sc">~</span>., imputed_test)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb106-6"><a href="http://localhost:6592/#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="http://localhost:6592/#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co">#fit final model</span></span>
<span id="cb106-8"><a href="http://localhost:6592/#cb106-8" aria-hidden="true" tabindex="-1"></a>LRFinal <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">1</span>, <span class="at">lambda=</span>.<span class="dv">1779</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="http://localhost:6592/#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">#generate predictions from test set</span></span>
<span id="cb107-2"><a href="http://localhost:6592/#cb107-2" aria-hidden="true" tabindex="-1"></a>x.test <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(OnTimeGrad <span class="sc">~</span> ., imputed_test) [,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb107-3"><a href="http://localhost:6592/#cb107-3" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> LRFinal <span class="sc">%&gt;%</span> <span class="fu">predict</span>(x.test) <span class="sc">%&gt;%</span> <span class="fu">as.vector</span>()</span>
<span id="cb107-4"><a href="http://localhost:6592/#cb107-4" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(predictions)</span>
<span id="cb107-5"><a href="http://localhost:6592/#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co">#replace negative values with 0</span></span>
<span id="cb107-6"><a href="http://localhost:6592/#cb107-6" aria-hidden="true" tabindex="-1"></a>predictions<span class="sc">$</span>predictions[predictions<span class="sc">$</span>predictions <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb107-7"><a href="http://localhost:6592/#cb107-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-8"><a href="http://localhost:6592/#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate RMSLE</span></span>
<span id="cb107-9"><a href="http://localhost:6592/#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rmsle</span>(predictions<span class="sc">$</span>predictions,imputed_test<span class="sc">$</span>OnTimeGrad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3740669</code></pre>
</div>
</div>
</section>
<section id="iirandom-forest-regression" class="level4">
<h4 class="anchored" data-anchor-id="iirandom-forest-regression">ii)Random Forest Regression<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#iirandom-forest-regression" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="http://localhost:6592/#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fit final model </span></span>
<span id="cb109-2"><a href="http://localhost:6592/#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb109-3"><a href="http://localhost:6592/#cb109-3" aria-hidden="true" tabindex="-1"></a>RFFinal <span class="ot">=</span> <span class="fu">ranger</span>(</span>
<span id="cb109-4"><a href="http://localhost:6592/#cb109-4" aria-hidden="true" tabindex="-1"></a>  OnTimeGrad <span class="sc">~</span> .,</span>
<span id="cb109-5"><a href="http://localhost:6592/#cb109-5" aria-hidden="true" tabindex="-1"></a>  imputed_test,</span>
<span id="cb109-6"><a href="http://localhost:6592/#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">importance =</span> <span class="st">'permutation'</span>,</span>
<span id="cb109-7"><a href="http://localhost:6592/#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry =</span> <span class="dv">5</span>,</span>
<span id="cb109-8"><a href="http://localhost:6592/#cb109-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">min.node.size =</span> <span class="dv">10</span>,</span>
<span id="cb109-9"><a href="http://localhost:6592/#cb109-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">num.trees =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="http://localhost:6592/#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#generate predictions from test set</span></span>
<span id="cb110-2"><a href="http://localhost:6592/#cb110-2" aria-hidden="true" tabindex="-1"></a>predictions2 <span class="ot">&lt;-</span> RFFinal <span class="sc">%&gt;%</span> <span class="fu">predict</span>(imputed_test)</span>
<span id="cb110-3"><a href="http://localhost:6592/#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate RMSLE</span></span>
<span id="cb110-4"><a href="http://localhost:6592/#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rmsle</span>(predictions2<span class="sc">$</span>predictions, imputed_test<span class="sc">$</span>OnTimeGrad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5963357</code></pre>
</div>
</div>
</section>
<section id="iii-support-vector-regression" class="level4">
<h4 class="anchored" data-anchor-id="iii-support-vector-regression">iii) Support Vector Regression<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#iii-support-vector-regression" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="http://localhost:6592/#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fit final model</span></span>
<span id="cb112-2"><a href="http://localhost:6592/#cb112-2" aria-hidden="true" tabindex="-1"></a>SVFinal <span class="ot">&lt;-</span> <span class="fu">svm</span>(OnTimeGrad <span class="sc">~</span> ., <span class="at">cost =</span> .<span class="dv">1052632</span>, <span class="at">data=</span>imputed_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="http://localhost:6592/#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#generate predictions from test set</span></span>
<span id="cb113-2"><a href="http://localhost:6592/#cb113-2" aria-hidden="true" tabindex="-1"></a>predictions3 <span class="ot">&lt;-</span> SVFinal <span class="sc">%&gt;%</span> <span class="fu">predict</span>(imputed_test)</span>
<span id="cb113-3"><a href="http://localhost:6592/#cb113-3" aria-hidden="true" tabindex="-1"></a>predictions3 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(predictions3)</span>
<span id="cb113-4"><a href="http://localhost:6592/#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate RMSLE</span></span>
<span id="cb113-5"><a href="http://localhost:6592/#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rmsle</span>(predictions3<span class="sc">$</span>predictions, imputed_test<span class="sc">$</span>OnTimeGrad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9107686</code></pre>
</div>
</div>
<p>With an RMSLE of .37, the lasso regression model should be the best fit for predicting the factors that contribute to on-time graduation of university undergraduates. Although the RMSE values of each model were quite close, using the RMSLE metric appears to help differentiate among them, as these values were much further from one another. Lasso regression is also a good choice because, unlike random forest or support vector regression, it is not a “black box” model and is easily explainable mathematically. The lasso model also seems to offer a good compromise between bias and variance, because the flexibility of having a tuning parameter and the fact that it penalizes having a large number of variables minimizes overfitting, while having a good size training set helps minimize underfitting.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="http://localhost:6592/#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate variable importance from final lasso model</span></span>
<span id="cb115-2"><a href="http://localhost:6592/#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="http://localhost:6592/#cb115-3" aria-hidden="true" tabindex="-1"></a>finaldata <span class="ot">&lt;-</span> <span class="fu">subset</span>(imputed_test, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(ID,Name)) </span>
<span id="cb115-4"><a href="http://localhost:6592/#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="http://localhost:6592/#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="co">#create outcome variable object</span></span>
<span id="cb115-6"><a href="http://localhost:6592/#cb115-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> finaldata<span class="sc">$</span>OnTimeGrad</span>
<span id="cb115-7"><a href="http://localhost:6592/#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="http://localhost:6592/#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="co">#create predictor variables object</span></span>
<span id="cb115-9"><a href="http://localhost:6592/#cb115-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(OnTimeGrad<span class="sc">~</span>., finaldata)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb115-10"><a href="http://localhost:6592/#cb115-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-11"><a href="http://localhost:6592/#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="co">#fit final model</span></span>
<span id="cb115-12"><a href="http://localhost:6592/#cb115-12" aria-hidden="true" tabindex="-1"></a>LRFinal <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">1</span>, <span class="at">lambda=</span>.<span class="dv">1779</span>)</span>
<span id="cb115-13"><a href="http://localhost:6592/#cb115-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-14"><a href="http://localhost:6592/#cb115-14" aria-hidden="true" tabindex="-1"></a><span class="fu">vip</span>(LRFinal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./MachineLearningAnalysisSpring2023_files/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The lasso regression model also allows for variable importance analysis, which is very helpful in this particular project because it shows which particular institutional characteristics have the greatest potential to influence on-time graduation, so universities with limited budgets could use the information to plan new services according to importance.</p>
</section>
</section>
</section>
<section id="ethical-implications" class="level2">
<h2 class="anchored" data-anchor-id="ethical-implications">7) Ethical Implications<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#ethical-implications" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>Since this predictive model is based on <em>institutional</em> characteristics, there is little possibility of incurring ethical issues in its use. Student-based models, on the other hand, could be fraught with potential bias or profiling based on misapplied assumptions about specific populations or demographic markers. Using data about institutional traits to predict student success targets in tandem with the input of substantively-informed decision-makers seems like an acceptable compromise between automation and fairness.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6592/#references" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>Attiya, W. M., &amp; Shams, M. B. (2023). Predicting Student Retention in Higher Education Using Data Mining Techniques: A Literature Review. <em>2023 International Conference On Cyber Management And Engineering (CyMaEn), Cyber Management And Engineering (CyMaEn), 2023 International Conference On</em>, 171–177. <a href="https://doi.org/10.1109/CyMaEn57228.2023.10051056" class="uri">https://doi.org/10.1109/CyMaEn57228.2023.10051056</a></p>
<p>Cardona, T., Cudney, E. A., Hoerl, R., &amp; Snyder, J. (2020). Data Mining and Machine Learning Retention Models in Higher Education. <em>Journal of College Student Retention: Research, Theory &amp; Practice</em>, <em>25</em>(1), 51–75. <a href="https://doi.org/10.1177/1521025120964920" class="uri">https://doi.org/10.1177/1521025120964920</a></p>
<p>Marsh, G. (2014). Institutional Characteristics and Student Retention in Public 4-Year Colleges and Universities. <em>Journal of College Student Retention: Research, Theory &amp; Practice</em>, <em>16</em>(1), 127–151. <a href="https://doi.org/10.2190/CS.16.1.g" class="uri">https://doi.org/10.2190/CS.16.1.g</a></p>
<p>Medved, S. (2022, April 27). <em>Why College Students May Not Graduate in Four Years—The Bottom Line UCSB</em>. <a href="https://thebottomline.as.ucsb.edu/2022/04/why-college-students-may-not-graduate-in-four-years" class="uri">https://thebottomline.as.ucsb.edu/2022/04/why-college-students-may-not-graduate-in-four-years</a></p>
<p>Moore, C., &amp; Shulock, N. (2009). <em>Student Progress Toward Degree Completion: Lessons From the Research Literature</em>. California State University Sacramento Institute for Higher Education Leadership &amp; Policy.</p>
<p>Oseguera, L. (2005). Four and Six-Year Baccalaureate Degree Completion by Institutional Characteristics and Racial/Ethnic Groups. <em>Journal of College Student Retention: Research, Theory &amp; Practice</em>, <em>7</em>(1/2), 19–59. <a href="https://doi.org/10.2190/E1TU-AW8J-5FYA-GLPW" class="uri">https://doi.org/10.2190/E1TU-AW8J-5FYA-GLPW</a></p>
<p>U.S. Department of Education. (2018). <em>National Center for Education Statistics, Integrated Postsecondary Education Data System (IPEDS), [data set]</em>. <a href="https://nces.ed.gov/ipeds/datacenter/InstitutionByName.aspx?goToReportId=1" class="uri">https://nces.ed.gov/ipeds/datacenter/InstitutionByName.aspx?goToReportId=1</a></p>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb116" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb116-1"><a href="http://localhost:6592/#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb116-2"><a href="http://localhost:6592/#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Institutional Characteristics Analysis"</span></span>
<span id="cb116-3"><a href="http://localhost:6592/#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Karen Detter"</span></span>
<span id="cb116-4"><a href="http://localhost:6592/#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="an">desription:</span><span class="co"> "Machine Learning for Social Science Project"</span></span>
<span id="cb116-5"><a href="http://localhost:6592/#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "5/25/2023"</span></span>
<span id="cb116-6"><a href="http://localhost:6592/#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb116-7"><a href="http://localhost:6592/#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb116-8"><a href="http://localhost:6592/#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb116-9"><a href="http://localhost:6592/#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb116-10"><a href="http://localhost:6592/#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb116-11"><a href="http://localhost:6592/#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb116-12"><a href="http://localhost:6592/#cb116-12" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb116-13"><a href="http://localhost:6592/#cb116-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-16"><a href="http://localhost:6592/#cb116-16" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-17"><a href="http://localhost:6592/#cb116-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb116-18"><a href="http://localhost:6592/#cb116-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-19"><a href="http://localhost:6592/#cb116-19" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-20"><a href="http://localhost:6592/#cb116-20" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-21"><a href="http://localhost:6592/#cb116-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-22"><a href="http://localhost:6592/#cb116-22" aria-hidden="true" tabindex="-1"></a><span class="fu"># Which Institutional Characteristics Can Predict Whether Undergraduate Students Graduate On Time?</span></span>
<span id="cb116-23"><a href="http://localhost:6592/#cb116-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-24"><a href="http://localhost:6592/#cb116-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1) Background</span></span>
<span id="cb116-25"><a href="http://localhost:6592/#cb116-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-26"><a href="http://localhost:6592/#cb116-26" aria-hidden="true" tabindex="-1"></a>Every fall, thousands of students enroll in undergraduate university programs with the expectation of obtaining a bachelor's degree after four years of study. In reality, less than half of those students will graduate within the traditional four-year time frame. According to the latest figures from the *Education Data Initiative*, just 41% of students meet that goal (Medved, 2022). Because this increase in time to degree attainment points to potential failures in higher education systems, and also equates to inflated debt load on students, much investigation has been done into the reasons for this phenomenon (Marsh, 2014; Moore &amp; Shulock, 2009; Oseguera, 2005). Some research studies have positioned student-centric variables as the determinants of on-time graduation, implying that there is little to be done about the issue on the institutions' end, outside of identifying and monitoring "at-risk" students. Others, however, have identified various institutional characteristics that have an impact on student ability to complete their degree programs in four years.</span>
<span id="cb116-27"><a href="http://localhost:6592/#cb116-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-28"><a href="http://localhost:6592/#cb116-28" aria-hidden="true" tabindex="-1"></a>Recently, researchers have begun applying machine learning models to analyze this important issue. Two meta-analyses of these studies showed that these techniques showed promising results in accurately predicting the factors that have a significant impact on retention and completion variables (Attiya &amp; Shams, 2023; Cardona et al, 2020). A wide variety of methods were employed across the studies included in these reviews; however, most of them used their own institution-level data sets. In fact, both meta-studies identified more expansive data as a target for future research. This project, therefore, seeks to add to the current literature by applying machine learning algorithms to data from a national clearinghouse of university surveys in order to predict which institutional factors influence the amount of students who graduate within four years.</span>
<span id="cb116-29"><a href="http://localhost:6592/#cb116-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-30"><a href="http://localhost:6592/#cb116-30" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2) Exploratory Data Analysis</span></span>
<span id="cb116-31"><a href="http://localhost:6592/#cb116-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-32"><a href="http://localhost:6592/#cb116-32" aria-hidden="true" tabindex="-1"></a>The data used for the model is from the National Center for Education Statistics' Data Center, a robust database containing thousands of data points self-reported annually by thousands of higher education institutions. Variables were selected according to those identified in the above-mentioned studies as being influential and filtered over US public and private (not-for-profit) 4-year degree-granting institutions. A custom data set was generated for information from the 2018-2019 school year. The resulting data set contains 1,803 observations for thirty variables.</span>
<span id="cb116-33"><a href="http://localhost:6592/#cb116-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-36"><a href="http://localhost:6592/#cb116-36" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-37"><a href="http://localhost:6592/#cb116-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  </span>
<span id="cb116-38"><a href="http://localhost:6592/#cb116-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)  </span>
<span id="cb116-39"><a href="http://localhost:6592/#cb116-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)  </span>
<span id="cb116-40"><a href="http://localhost:6592/#cb116-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)  </span>
<span id="cb116-41"><a href="http://localhost:6592/#cb116-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)  </span>
<span id="cb116-42"><a href="http://localhost:6592/#cb116-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger)  </span>
<span id="cb116-43"><a href="http://localhost:6592/#cb116-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)  </span>
<span id="cb116-44"><a href="http://localhost:6592/#cb116-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mltools) </span>
<span id="cb116-45"><a href="http://localhost:6592/#cb116-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) </span>
<span id="cb116-46"><a href="http://localhost:6592/#cb116-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caTools) </span>
<span id="cb116-47"><a href="http://localhost:6592/#cb116-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class) </span>
<span id="cb116-48"><a href="http://localhost:6592/#cb116-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb116-49"><a href="http://localhost:6592/#cb116-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MLmetrics)</span>
<span id="cb116-50"><a href="http://localhost:6592/#cb116-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb116-51"><a href="http://localhost:6592/#cb116-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb116-52"><a href="http://localhost:6592/#cb116-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-53"><a href="http://localhost:6592/#cb116-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-56"><a href="http://localhost:6592/#cb116-56" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-57"><a href="http://localhost:6592/#cb116-57" aria-hidden="true" tabindex="-1"></a><span class="co">#load data set </span></span>
<span id="cb116-58"><a href="http://localhost:6592/#cb116-58" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/IPEDS_data.csv"</span>)  </span>
<span id="cb116-59"><a href="http://localhost:6592/#cb116-59" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data)</span>
<span id="cb116-60"><a href="http://localhost:6592/#cb116-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-61"><a href="http://localhost:6592/#cb116-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-62"><a href="http://localhost:6592/#cb116-62" aria-hidden="true" tabindex="-1"></a><span class="fu">### a) Description of Variables</span></span>
<span id="cb116-63"><a href="http://localhost:6592/#cb116-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-64"><a href="http://localhost:6592/#cb116-64" aria-hidden="true" tabindex="-1"></a>All variables (besides identifiers) are either dichotomous (yes/no) or continuous (% and \$) and can be sorted across the following categories:</span>
<span id="cb116-65"><a href="http://localhost:6592/#cb116-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-66"><a href="http://localhost:6592/#cb116-66" aria-hidden="true" tabindex="-1"></a>**Credits Allowed** includes: *MilCr*-credit given for military service, *DualCr*-college credit can be earned in high school, *LifeCr*-credit given for life experience, *APCr*-Advanced Placement credits accepted</span>
<span id="cb116-67"><a href="http://localhost:6592/#cb116-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-68"><a href="http://localhost:6592/#cb116-68" aria-hidden="true" tabindex="-1"></a>**Services Offered** includes: *VetOrg*-veteran student organization available, *ExpHrs*-weekend/evening classes available, *RemedSvcs*-remedial services available, *AcadCouns*-academic counseling available, *Emp*-employment services for students available, *PlSvcs*-placement services for graduates available, *Daycare*- on-campus daycare services offered, *Online*-undergraduate distance learning offered, *Library*-physical library provided, *LibRes*-access to electronic resources provided, *LibStaff*-library staff available for consult, *LibShare*-access to other institutional libraries available, *Libs*-number of library branches, *Books*-as % of library collection, *Serials*-as % of library collection, *Ebooks*-as % of library collection, *DB*-databases as % of library collection, *Digital*-digital media as % of library collection</span>
<span id="cb116-69"><a href="http://localhost:6592/#cb116-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-70"><a href="http://localhost:6592/#cb116-70" aria-hidden="true" tabindex="-1"></a>**Institutional Profile** includes: *ID*-numeric identifier, *Name*, *Select*-% of applicants accepted</span>
<span id="cb116-71"><a href="http://localhost:6592/#cb116-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-72"><a href="http://localhost:6592/#cb116-72" aria-hidden="true" tabindex="-1"></a>**Financial** includes: *Cost*- total \$ tuition &amp; fees, Aid-% of students receiving any form of tuition assistance, AidAvg-average \$ amount of aid received per student, *InstrExp*- per-student \$ expediture on instruction, *SuppExp*- per-student \$ expenditure on student support services, *SvcsExp*- per-student \$ expenditure on other student services</span>
<span id="cb116-73"><a href="http://localhost:6592/#cb116-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-74"><a href="http://localhost:6592/#cb116-74" aria-hidden="true" tabindex="-1"></a>**Dependent Variable**: *OnTimeGrad*- % of students who graduated with a bachelor's degree in 4 years (as reported for 2019)</span>
<span id="cb116-75"><a href="http://localhost:6592/#cb116-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-76"><a href="http://localhost:6592/#cb116-76" aria-hidden="true" tabindex="-1"></a><span class="fu">### b) Transformation of Variables</span></span>
<span id="cb116-77"><a href="http://localhost:6592/#cb116-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-78"><a href="http://localhost:6592/#cb116-78" aria-hidden="true" tabindex="-1"></a>Because the data set was able to be customized directly from the database, not much wrangling is required. Some variables do, however, need to be transformed. Since this process will not substantively change the data values, it can be done on the full data set.</span>
<span id="cb116-79"><a href="http://localhost:6592/#cb116-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-82"><a href="http://localhost:6592/#cb116-82" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-83"><a href="http://localhost:6592/#cb116-83" aria-hidden="true" tabindex="-1"></a><span class="co">#create binary variables for yes/no vectors  </span></span>
<span id="cb116-84"><a href="http://localhost:6592/#cb116-84" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">MilCr =</span> <span class="fu">case_when</span>(     MilCr <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     MilCr <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb116-85"><a href="http://localhost:6592/#cb116-85" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">VetOrg =</span> <span class="fu">case_when</span>(     VetOrg <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     VetOrg <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb116-86"><a href="http://localhost:6592/#cb116-86" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">DualCr =</span> <span class="fu">case_when</span>(     DualCr <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     DualCr <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb116-87"><a href="http://localhost:6592/#cb116-87" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">LifeCr =</span> <span class="fu">case_when</span>(     LifeCr <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     LifeCr <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb116-88"><a href="http://localhost:6592/#cb116-88" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">APCr =</span> <span class="fu">case_when</span>(     APCr <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     APCr <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb116-89"><a href="http://localhost:6592/#cb116-89" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">ExpHrs =</span> <span class="fu">case_when</span>(     ExpHrs <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     ExpHrs <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb116-90"><a href="http://localhost:6592/#cb116-90" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">RemedSvcs =</span> <span class="fu">case_when</span>(     RemedSvcs <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     RemedSvcs <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb116-91"><a href="http://localhost:6592/#cb116-91" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">AcadCouns =</span> <span class="fu">case_when</span>(     AcadCouns <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     AcadCouns <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb116-92"><a href="http://localhost:6592/#cb116-92" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">Emp =</span> <span class="fu">case_when</span>(     Emp <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     Emp <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb116-93"><a href="http://localhost:6592/#cb116-93" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">PlSvcs =</span> <span class="fu">case_when</span>(     PlSvcs <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     PlSvcs <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb116-94"><a href="http://localhost:6592/#cb116-94" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">Daycare =</span> <span class="fu">case_when</span>(     Daycare <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     Daycare <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb116-95"><a href="http://localhost:6592/#cb116-95" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">Online =</span> <span class="fu">case_when</span>(     Online <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     Online <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb116-96"><a href="http://localhost:6592/#cb116-96" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">Library =</span> <span class="fu">case_when</span>(     Library <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     Library <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb116-97"><a href="http://localhost:6592/#cb116-97" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">LibRes =</span> <span class="fu">case_when</span>(     LibRes <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     LibRes <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb116-98"><a href="http://localhost:6592/#cb116-98" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">LibStaff =</span> <span class="fu">case_when</span>(     LibStaff <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     LibStaff <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))  </span>
<span id="cb116-99"><a href="http://localhost:6592/#cb116-99" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">LibShare =</span> <span class="fu">case_when</span>(     LibShare <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,     LibShare <span class="sc">==</span> <span class="st">"Implied no"</span> <span class="sc">~</span> <span class="dv">0</span>))</span>
<span id="cb116-100"><a href="http://localhost:6592/#cb116-100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-101"><a href="http://localhost:6592/#cb116-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-104"><a href="http://localhost:6592/#cb116-104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-105"><a href="http://localhost:6592/#cb116-105" aria-hidden="true" tabindex="-1"></a><span class="co">#examine cleaned data </span></span>
<span id="cb116-106"><a href="http://localhost:6592/#cb116-106" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span>
<span id="cb116-107"><a href="http://localhost:6592/#cb116-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-108"><a href="http://localhost:6592/#cb116-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-109"><a href="http://localhost:6592/#cb116-109" aria-hidden="true" tabindex="-1"></a>An examination of the variable ranges shows a few large outlier values (within the expenditures variables), but the mean, median, and quartile measures indicate that distribution should be reasonably normal. The expenditures variables also have a large amount of *NA* values that will need to be imputed, which theoretically could substantially change the evaluation and applicability of the model. The missing values are likely due to unavailability of data, so imputation is the only option because expenditures are intuitively important variables to be included in the predictive models.</span>
<span id="cb116-110"><a href="http://localhost:6592/#cb116-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-111"><a href="http://localhost:6592/#cb116-111" aria-hidden="true" tabindex="-1"></a>The data is now ready to be split. Because the data set is somewhat small, the training set will be set to 70% and the test set to 30%, to ensure that both sets are sufficiently representative of the data.</span>
<span id="cb116-112"><a href="http://localhost:6592/#cb116-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-115"><a href="http://localhost:6592/#cb116-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-116"><a href="http://localhost:6592/#cb116-116" aria-hidden="true" tabindex="-1"></a><span class="co">#split into training and test sets  </span></span>
<span id="cb116-117"><a href="http://localhost:6592/#cb116-117" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb116-118"><a href="http://localhost:6592/#cb116-118" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">size =</span> <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">7</span>, .<span class="dv">3</span>)) </span>
<span id="cb116-119"><a href="http://localhost:6592/#cb116-119" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> data[idx <span class="sc">==</span> <span class="dv">1</span>,] </span>
<span id="cb116-120"><a href="http://localhost:6592/#cb116-120" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> data[idx <span class="sc">==</span> <span class="dv">2</span>,]</span>
<span id="cb116-121"><a href="http://localhost:6592/#cb116-121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-122"><a href="http://localhost:6592/#cb116-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-123"><a href="http://localhost:6592/#cb116-123" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3) Evaluation Metric</span></span>
<span id="cb116-124"><a href="http://localhost:6592/#cb116-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-125"><a href="http://localhost:6592/#cb116-125" aria-hidden="true" tabindex="-1"></a>Because the variable of interest, the percentage of students who graduate in four years, is continuous, and the problem to be addressed is one of prediction, regression methods will be the most appropriate models. As such, the metric used in k-fold cross validation to compare model performance will be Root Mean Squared Error. RMSE is a common metric for evaluating regression models, and is a readily available calculation in many R packages. It is a simple computation that measures the average difference between predicted and actual values, making it easy to explain.</span>
<span id="cb116-126"><a href="http://localhost:6592/#cb116-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-127"><a href="http://localhost:6592/#cb116-127" aria-hidden="true" tabindex="-1"></a>RMSLE is likely a more appropriate metric for this data set, as it is neither scale-dependent nor sensitive to outliers. However, it is not readily available as a metric in any well-known R packages with cross validation functions, and customizing the metric would require extensive time and effort, whereas RMSE is an acceptable default metric. As such, as a compromise between precision and efficiency, it will be used to compare performance across models after parameter tuning has been completed.</span>
<span id="cb116-128"><a href="http://localhost:6592/#cb116-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-129"><a href="http://localhost:6592/#cb116-129" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4) Data Preprocessing</span></span>
<span id="cb116-130"><a href="http://localhost:6592/#cb116-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-131"><a href="http://localhost:6592/#cb116-131" aria-hidden="true" tabindex="-1"></a><span class="fu">### a) Impute NA values</span></span>
<span id="cb116-132"><a href="http://localhost:6592/#cb116-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-133"><a href="http://localhost:6592/#cb116-133" aria-hidden="true" tabindex="-1"></a>There are many missing values in the expenditure variable vectors, so these will be imputed using the multiple imputation method of predictive mean matching.</span>
<span id="cb116-134"><a href="http://localhost:6592/#cb116-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-137"><a href="http://localhost:6592/#cb116-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-138"><a href="http://localhost:6592/#cb116-138" aria-hidden="true" tabindex="-1"></a><span class="co">#subset training without character variables  </span></span>
<span id="cb116-139"><a href="http://localhost:6592/#cb116-139" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> <span class="fu">subset</span>(training, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(ID,Name)) </span>
<span id="cb116-140"><a href="http://localhost:6592/#cb116-140" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-141"><a href="http://localhost:6592/#cb116-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-144"><a href="http://localhost:6592/#cb116-144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-145"><a href="http://localhost:6592/#cb116-145" aria-hidden="true" tabindex="-1"></a>init <span class="ot">=</span> <span class="fu">mice</span>(training, <span class="at">maxit=</span><span class="dv">0</span>)</span>
<span id="cb116-146"><a href="http://localhost:6592/#cb116-146" aria-hidden="true" tabindex="-1"></a>meth <span class="ot">=</span> init<span class="sc">$</span>method</span>
<span id="cb116-147"><a href="http://localhost:6592/#cb116-147" aria-hidden="true" tabindex="-1"></a>predM<span class="ot">=</span>init<span class="sc">$</span>predictorMatrix</span>
<span id="cb116-148"><a href="http://localhost:6592/#cb116-148" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"InstrExp"</span>)]<span class="ot">=</span><span class="st">'pmm'</span></span>
<span id="cb116-149"><a href="http://localhost:6592/#cb116-149" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"SuppExp"</span>)]<span class="ot">=</span><span class="st">'pmm'</span></span>
<span id="cb116-150"><a href="http://localhost:6592/#cb116-150" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"SvcsExp"</span>)]<span class="ot">=</span><span class="st">'pmm'</span></span>
<span id="cb116-151"><a href="http://localhost:6592/#cb116-151" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb116-152"><a href="http://localhost:6592/#cb116-152" aria-hidden="true" tabindex="-1"></a>imputed <span class="ot">=</span> <span class="fu">mice</span>(training, <span class="at">method=</span>meth, <span class="at">predictorMatrix=</span>predM, <span class="at">m=</span><span class="dv">5</span>)</span>
<span id="cb116-153"><a href="http://localhost:6592/#cb116-153" aria-hidden="true" tabindex="-1"></a>imputed_training <span class="ot">&lt;-</span> <span class="fu">complete</span>(imputed)</span>
<span id="cb116-154"><a href="http://localhost:6592/#cb116-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-155"><a href="http://localhost:6592/#cb116-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-158"><a href="http://localhost:6592/#cb116-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-159"><a href="http://localhost:6592/#cb116-159" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(imputed_training, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb116-160"><a href="http://localhost:6592/#cb116-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-161"><a href="http://localhost:6592/#cb116-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-162"><a href="http://localhost:6592/#cb116-162" aria-hidden="true" tabindex="-1"></a>Since all of the data vectors have been imputed with predicted estimated values, the new training set is ready to be used for model fitting.</span>
<span id="cb116-163"><a href="http://localhost:6592/#cb116-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-164"><a href="http://localhost:6592/#cb116-164" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5) Fit Models</span></span>
<span id="cb116-165"><a href="http://localhost:6592/#cb116-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-166"><a href="http://localhost:6592/#cb116-166" aria-hidden="true" tabindex="-1"></a>Based on their performance in previous research studies, lasso, random forest, and support vector regression models will be built. The properties of these three methods make them appropriate for data sets with a large number of variables and potential outliers.</span>
<span id="cb116-167"><a href="http://localhost:6592/#cb116-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-168"><a href="http://localhost:6592/#cb116-168" aria-hidden="true" tabindex="-1"></a>As a first step, relationships among variables are assessed visually.</span>
<span id="cb116-169"><a href="http://localhost:6592/#cb116-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-172"><a href="http://localhost:6592/#cb116-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-173"><a href="http://localhost:6592/#cb116-173" aria-hidden="true" tabindex="-1"></a><span class="co">#assess multicollinearity </span></span>
<span id="cb116-174"><a href="http://localhost:6592/#cb116-174" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fu">cor</span>(imputed_training) </span>
<span id="cb116-175"><a href="http://localhost:6592/#cb116-175" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(c)  </span>
<span id="cb116-176"><a href="http://localhost:6592/#cb116-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-177"><a href="http://localhost:6592/#cb116-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-178"><a href="http://localhost:6592/#cb116-178" aria-hidden="true" tabindex="-1"></a>It appears that *Cost* &amp; *AidAvg* and *Book*s &amp; *Ebooks* may be collinear, but not necessarily to a great enough degree to remove the variables, as they are likely still important to the model.</span>
<span id="cb116-179"><a href="http://localhost:6592/#cb116-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-180"><a href="http://localhost:6592/#cb116-180" aria-hidden="true" tabindex="-1"></a><span class="fu">### a) Lasso Regression</span></span>
<span id="cb116-181"><a href="http://localhost:6592/#cb116-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-184"><a href="http://localhost:6592/#cb116-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-185"><a href="http://localhost:6592/#cb116-185" aria-hidden="true" tabindex="-1"></a><span class="co">#create outcome variable object</span></span>
<span id="cb116-186"><a href="http://localhost:6592/#cb116-186" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> imputed_training<span class="sc">$</span>OnTimeGrad</span>
<span id="cb116-187"><a href="http://localhost:6592/#cb116-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-188"><a href="http://localhost:6592/#cb116-188" aria-hidden="true" tabindex="-1"></a><span class="co">#create predictor variables object</span></span>
<span id="cb116-189"><a href="http://localhost:6592/#cb116-189" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(OnTimeGrad<span class="sc">~</span>., imputed_training)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb116-190"><a href="http://localhost:6592/#cb116-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-191"><a href="http://localhost:6592/#cb116-191" aria-hidden="true" tabindex="-1"></a><span class="co">#find the best value for lambda using cross-validation</span></span>
<span id="cb116-192"><a href="http://localhost:6592/#cb116-192" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb116-193"><a href="http://localhost:6592/#cb116-193" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x,y,<span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb116-194"><a href="http://localhost:6592/#cb116-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-195"><a href="http://localhost:6592/#cb116-195" aria-hidden="true" tabindex="-1"></a><span class="co">#fit model</span></span>
<span id="cb116-196"><a href="http://localhost:6592/#cb116-196" aria-hidden="true" tabindex="-1"></a>LR <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">1</span>, <span class="at">lambda=</span>cv<span class="sc">$</span>lambda.min)</span>
<span id="cb116-197"><a href="http://localhost:6592/#cb116-197" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(LR)</span>
<span id="cb116-198"><a href="http://localhost:6592/#cb116-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-199"><a href="http://localhost:6592/#cb116-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-202"><a href="http://localhost:6592/#cb116-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-203"><a href="http://localhost:6592/#cb116-203" aria-hidden="true" tabindex="-1"></a><span class="co">#k-fold cross validation  </span></span>
<span id="cb116-204"><a href="http://localhost:6592/#cb116-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-205"><a href="http://localhost:6592/#cb116-205" aria-hidden="true" tabindex="-1"></a><span class="co">#define training control </span></span>
<span id="cb116-206"><a href="http://localhost:6592/#cb116-206" aria-hidden="true" tabindex="-1"></a>control <span class="ot">=</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>,                      </span>
<span id="cb116-207"><a href="http://localhost:6592/#cb116-207" aria-hidden="true" tabindex="-1"></a>                       <span class="at">number =</span> <span class="dv">10</span>)  </span>
<span id="cb116-208"><a href="http://localhost:6592/#cb116-208" aria-hidden="true" tabindex="-1"></a><span class="co">#train model  </span></span>
<span id="cb116-209"><a href="http://localhost:6592/#cb116-209" aria-hidden="true" tabindex="-1"></a>LRmodel <span class="ot">&lt;-</span> <span class="fu">train</span>(OnTimeGrad <span class="sc">~</span> ., <span class="at">data =</span> imputed_training, <span class="at">method =</span> <span class="st">"glmnet"</span>,    <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> .<span class="dv">1779</span>), <span class="at">trControl =</span> control, <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">'scale'</span>))</span>
<span id="cb116-210"><a href="http://localhost:6592/#cb116-210" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(LRmodel)</span>
<span id="cb116-211"><a href="http://localhost:6592/#cb116-211" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-212"><a href="http://localhost:6592/#cb116-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-213"><a href="http://localhost:6592/#cb116-213" aria-hidden="true" tabindex="-1"></a><span class="fu">### b) Random Forest Regression</span></span>
<span id="cb116-214"><a href="http://localhost:6592/#cb116-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-217"><a href="http://localhost:6592/#cb116-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-218"><a href="http://localhost:6592/#cb116-218" aria-hidden="true" tabindex="-1"></a><span class="co">#fit model </span></span>
<span id="cb116-219"><a href="http://localhost:6592/#cb116-219" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb116-220"><a href="http://localhost:6592/#cb116-220" aria-hidden="true" tabindex="-1"></a>RFmodel <span class="ot">=</span> <span class="fu">ranger</span>(</span>
<span id="cb116-221"><a href="http://localhost:6592/#cb116-221" aria-hidden="true" tabindex="-1"></a>  OnTimeGrad <span class="sc">~</span> .,</span>
<span id="cb116-222"><a href="http://localhost:6592/#cb116-222" aria-hidden="true" tabindex="-1"></a>  imputed_training,</span>
<span id="cb116-223"><a href="http://localhost:6592/#cb116-223" aria-hidden="true" tabindex="-1"></a>  <span class="at">importance =</span> <span class="st">'permutation'</span>,</span>
<span id="cb116-224"><a href="http://localhost:6592/#cb116-224" aria-hidden="true" tabindex="-1"></a>  <span class="at">num.trees =</span> <span class="dv">1000</span>)</span>
<span id="cb116-225"><a href="http://localhost:6592/#cb116-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-226"><a href="http://localhost:6592/#cb116-226" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(RFmodel)</span>
<span id="cb116-227"><a href="http://localhost:6592/#cb116-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-228"><a href="http://localhost:6592/#cb116-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-231"><a href="http://localhost:6592/#cb116-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-232"><a href="http://localhost:6592/#cb116-232" aria-hidden="true" tabindex="-1"></a><span class="co">#k-fold cross validation  </span></span>
<span id="cb116-233"><a href="http://localhost:6592/#cb116-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-234"><a href="http://localhost:6592/#cb116-234" aria-hidden="true" tabindex="-1"></a><span class="co">#define training control </span></span>
<span id="cb116-235"><a href="http://localhost:6592/#cb116-235" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">'repeatedcv'</span>, </span>
<span id="cb116-236"><a href="http://localhost:6592/#cb116-236" aria-hidden="true" tabindex="-1"></a>                        <span class="at">number=</span><span class="dv">10</span>, </span>
<span id="cb116-237"><a href="http://localhost:6592/#cb116-237" aria-hidden="true" tabindex="-1"></a>                        <span class="at">repeats=</span><span class="dv">3</span>, </span>
<span id="cb116-238"><a href="http://localhost:6592/#cb116-238" aria-hidden="true" tabindex="-1"></a>                        <span class="at">search=</span><span class="st">'grid'</span>)</span>
<span id="cb116-239"><a href="http://localhost:6592/#cb116-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-240"><a href="http://localhost:6592/#cb116-240" aria-hidden="true" tabindex="-1"></a>tunegrid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb116-241"><a href="http://localhost:6592/#cb116-241" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,</span>
<span id="cb116-242"><a href="http://localhost:6592/#cb116-242" aria-hidden="true" tabindex="-1"></a>  <span class="at">splitrule =</span> <span class="st">"variance"</span>,</span>
<span id="cb116-243"><a href="http://localhost:6592/#cb116-243" aria-hidden="true" tabindex="-1"></a>  <span class="at">min.node.size =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb116-244"><a href="http://localhost:6592/#cb116-244" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-245"><a href="http://localhost:6592/#cb116-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-246"><a href="http://localhost:6592/#cb116-246" aria-hidden="true" tabindex="-1"></a><span class="co">#train model  </span></span>
<span id="cb116-247"><a href="http://localhost:6592/#cb116-247" aria-hidden="true" tabindex="-1"></a>RF <span class="ot">&lt;-</span> <span class="fu">train</span>( OnTimeGrad <span class="sc">~</span>., </span>
<span id="cb116-248"><a href="http://localhost:6592/#cb116-248" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> imputed_training,</span>
<span id="cb116-249"><a href="http://localhost:6592/#cb116-249" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">'ranger'</span>,</span>
<span id="cb116-250"><a href="http://localhost:6592/#cb116-250" aria-hidden="true" tabindex="-1"></a>                       <span class="at">metric =</span> <span class="st">'RMSE'</span>,</span>
<span id="cb116-251"><a href="http://localhost:6592/#cb116-251" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tuneGrid =</span> tunegrid)</span>
<span id="cb116-252"><a href="http://localhost:6592/#cb116-252" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(RF)</span>
<span id="cb116-253"><a href="http://localhost:6592/#cb116-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-254"><a href="http://localhost:6592/#cb116-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-255"><a href="http://localhost:6592/#cb116-255" aria-hidden="true" tabindex="-1"></a><span class="fu">### c) Support Vector Regression</span></span>
<span id="cb116-256"><a href="http://localhost:6592/#cb116-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-259"><a href="http://localhost:6592/#cb116-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-260"><a href="http://localhost:6592/#cb116-260" aria-hidden="true" tabindex="-1"></a><span class="co">#fit model with training data  </span></span>
<span id="cb116-261"><a href="http://localhost:6592/#cb116-261" aria-hidden="true" tabindex="-1"></a>SVmodel <span class="ot">&lt;-</span> <span class="fu">svm</span>(OnTimeGrad <span class="sc">~</span> ., <span class="at">data=</span>imputed_training)</span>
<span id="cb116-262"><a href="http://localhost:6592/#cb116-262" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(SVmodel)</span>
<span id="cb116-263"><a href="http://localhost:6592/#cb116-263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-264"><a href="http://localhost:6592/#cb116-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-267"><a href="http://localhost:6592/#cb116-267" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-268"><a href="http://localhost:6592/#cb116-268" aria-hidden="true" tabindex="-1"></a><span class="co">#cross validation   </span></span>
<span id="cb116-269"><a href="http://localhost:6592/#cb116-269" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb116-270"><a href="http://localhost:6592/#cb116-270" aria-hidden="true" tabindex="-1"></a>SV <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb116-271"><a href="http://localhost:6592/#cb116-271" aria-hidden="true" tabindex="-1"></a>  OnTimeGrad <span class="sc">~</span>., <span class="at">data =</span> imputed_training, <span class="at">method =</span> <span class="st">"svmLinear2"</span>,</span>
<span id="cb116-272"><a href="http://localhost:6592/#cb116-272" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb116-273"><a href="http://localhost:6592/#cb116-273" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">cost =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">20</span>)),</span>
<span id="cb116-274"><a href="http://localhost:6592/#cb116-274" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"scale"</span>)</span>
<span id="cb116-275"><a href="http://localhost:6592/#cb116-275" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-276"><a href="http://localhost:6592/#cb116-276" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot model accuracy vs different values of Cost</span></span>
<span id="cb116-277"><a href="http://localhost:6592/#cb116-277" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(SV)</span>
<span id="cb116-278"><a href="http://localhost:6592/#cb116-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-279"><a href="http://localhost:6592/#cb116-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-282"><a href="http://localhost:6592/#cb116-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-283"><a href="http://localhost:6592/#cb116-283" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the best tuning parameter C that</span></span>
<span id="cb116-284"><a href="http://localhost:6592/#cb116-284" aria-hidden="true" tabindex="-1"></a><span class="co"># maximizes model accuracy</span></span>
<span id="cb116-285"><a href="http://localhost:6592/#cb116-285" aria-hidden="true" tabindex="-1"></a>SV<span class="sc">$</span>bestTune</span>
<span id="cb116-286"><a href="http://localhost:6592/#cb116-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-287"><a href="http://localhost:6592/#cb116-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-288"><a href="http://localhost:6592/#cb116-288" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6) Compare Models</span></span>
<span id="cb116-289"><a href="http://localhost:6592/#cb116-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-290"><a href="http://localhost:6592/#cb116-290" aria-hidden="true" tabindex="-1"></a>The RMSE values for the models as fitted are 14.85 for lasso regression, 14.87 for random forest regression, and 15.10 for support vector regression. To make a final evaluation of which model is most accurate, the tuned models will be compared on the more appropriate metric of RMSLE.</span>
<span id="cb116-291"><a href="http://localhost:6592/#cb116-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-292"><a href="http://localhost:6592/#cb116-292" aria-hidden="true" tabindex="-1"></a><span class="fu">### a) Evaluate all tuned models on RMSLE with test data set</span></span>
<span id="cb116-293"><a href="http://localhost:6592/#cb116-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-296"><a href="http://localhost:6592/#cb116-296" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-297"><a href="http://localhost:6592/#cb116-297" aria-hidden="true" tabindex="-1"></a><span class="co">#data preprocessing of test set</span></span>
<span id="cb116-298"><a href="http://localhost:6592/#cb116-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-299"><a href="http://localhost:6592/#cb116-299" aria-hidden="true" tabindex="-1"></a>init <span class="ot">=</span> <span class="fu">mice</span>(test, <span class="at">maxit=</span><span class="dv">0</span>)</span>
<span id="cb116-300"><a href="http://localhost:6592/#cb116-300" aria-hidden="true" tabindex="-1"></a>meth <span class="ot">=</span> init<span class="sc">$</span>method</span>
<span id="cb116-301"><a href="http://localhost:6592/#cb116-301" aria-hidden="true" tabindex="-1"></a>predM<span class="ot">=</span>init<span class="sc">$</span>predictorMatrix</span>
<span id="cb116-302"><a href="http://localhost:6592/#cb116-302" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"InstrExp"</span>)]<span class="ot">=</span><span class="st">'pmm'</span></span>
<span id="cb116-303"><a href="http://localhost:6592/#cb116-303" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"SuppExp"</span>)]<span class="ot">=</span><span class="st">'pmm'</span></span>
<span id="cb116-304"><a href="http://localhost:6592/#cb116-304" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"SvcsExp"</span>)]<span class="ot">=</span><span class="st">'pmm'</span></span>
<span id="cb116-305"><a href="http://localhost:6592/#cb116-305" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb116-306"><a href="http://localhost:6592/#cb116-306" aria-hidden="true" tabindex="-1"></a>imputed2 <span class="ot">=</span> <span class="fu">mice</span>(test, <span class="at">method=</span>meth, <span class="at">predictorMatrix=</span>predM, <span class="at">m=</span><span class="dv">5</span>)</span>
<span id="cb116-307"><a href="http://localhost:6592/#cb116-307" aria-hidden="true" tabindex="-1"></a>imputed_test <span class="ot">&lt;-</span> <span class="fu">complete</span>(imputed2)</span>
<span id="cb116-308"><a href="http://localhost:6592/#cb116-308" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(imputed_test, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb116-309"><a href="http://localhost:6592/#cb116-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-310"><a href="http://localhost:6592/#cb116-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-311"><a href="http://localhost:6592/#cb116-311" aria-hidden="true" tabindex="-1"></a><span class="fu">#### i) Lasso Regression</span></span>
<span id="cb116-312"><a href="http://localhost:6592/#cb116-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-315"><a href="http://localhost:6592/#cb116-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-316"><a href="http://localhost:6592/#cb116-316" aria-hidden="true" tabindex="-1"></a><span class="co">#create outcome variable object</span></span>
<span id="cb116-317"><a href="http://localhost:6592/#cb116-317" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> imputed_test<span class="sc">$</span>OnTimeGrad</span>
<span id="cb116-318"><a href="http://localhost:6592/#cb116-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-319"><a href="http://localhost:6592/#cb116-319" aria-hidden="true" tabindex="-1"></a><span class="co">#create predictor variables object</span></span>
<span id="cb116-320"><a href="http://localhost:6592/#cb116-320" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(OnTimeGrad<span class="sc">~</span>., imputed_test)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb116-321"><a href="http://localhost:6592/#cb116-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-322"><a href="http://localhost:6592/#cb116-322" aria-hidden="true" tabindex="-1"></a><span class="co">#fit final model</span></span>
<span id="cb116-323"><a href="http://localhost:6592/#cb116-323" aria-hidden="true" tabindex="-1"></a>LRFinal <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">1</span>, <span class="at">lambda=</span>.<span class="dv">1779</span>)</span>
<span id="cb116-324"><a href="http://localhost:6592/#cb116-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-325"><a href="http://localhost:6592/#cb116-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-328"><a href="http://localhost:6592/#cb116-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-329"><a href="http://localhost:6592/#cb116-329" aria-hidden="true" tabindex="-1"></a><span class="co">#generate predictions from test set</span></span>
<span id="cb116-330"><a href="http://localhost:6592/#cb116-330" aria-hidden="true" tabindex="-1"></a>x.test <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(OnTimeGrad <span class="sc">~</span> ., imputed_test) [,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb116-331"><a href="http://localhost:6592/#cb116-331" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> LRFinal <span class="sc">%&gt;%</span> <span class="fu">predict</span>(x.test) <span class="sc">%&gt;%</span> <span class="fu">as.vector</span>()</span>
<span id="cb116-332"><a href="http://localhost:6592/#cb116-332" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(predictions)</span>
<span id="cb116-333"><a href="http://localhost:6592/#cb116-333" aria-hidden="true" tabindex="-1"></a><span class="co">#replace negative values with 0</span></span>
<span id="cb116-334"><a href="http://localhost:6592/#cb116-334" aria-hidden="true" tabindex="-1"></a>predictions<span class="sc">$</span>predictions[predictions<span class="sc">$</span>predictions <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb116-335"><a href="http://localhost:6592/#cb116-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-336"><a href="http://localhost:6592/#cb116-336" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate RMSLE</span></span>
<span id="cb116-337"><a href="http://localhost:6592/#cb116-337" aria-hidden="true" tabindex="-1"></a><span class="fu">rmsle</span>(predictions<span class="sc">$</span>predictions,imputed_test<span class="sc">$</span>OnTimeGrad)</span>
<span id="cb116-338"><a href="http://localhost:6592/#cb116-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-339"><a href="http://localhost:6592/#cb116-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-340"><a href="http://localhost:6592/#cb116-340" aria-hidden="true" tabindex="-1"></a><span class="fu">#### ii)Random Forest Regression</span></span>
<span id="cb116-341"><a href="http://localhost:6592/#cb116-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-344"><a href="http://localhost:6592/#cb116-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-345"><a href="http://localhost:6592/#cb116-345" aria-hidden="true" tabindex="-1"></a><span class="co">#fit final model </span></span>
<span id="cb116-346"><a href="http://localhost:6592/#cb116-346" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb116-347"><a href="http://localhost:6592/#cb116-347" aria-hidden="true" tabindex="-1"></a>RFFinal <span class="ot">=</span> <span class="fu">ranger</span>(</span>
<span id="cb116-348"><a href="http://localhost:6592/#cb116-348" aria-hidden="true" tabindex="-1"></a>  OnTimeGrad <span class="sc">~</span> .,</span>
<span id="cb116-349"><a href="http://localhost:6592/#cb116-349" aria-hidden="true" tabindex="-1"></a>  imputed_test,</span>
<span id="cb116-350"><a href="http://localhost:6592/#cb116-350" aria-hidden="true" tabindex="-1"></a>  <span class="at">importance =</span> <span class="st">'permutation'</span>,</span>
<span id="cb116-351"><a href="http://localhost:6592/#cb116-351" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry =</span> <span class="dv">5</span>,</span>
<span id="cb116-352"><a href="http://localhost:6592/#cb116-352" aria-hidden="true" tabindex="-1"></a>  <span class="at">min.node.size =</span> <span class="dv">10</span>,</span>
<span id="cb116-353"><a href="http://localhost:6592/#cb116-353" aria-hidden="true" tabindex="-1"></a>  <span class="at">num.trees =</span> <span class="dv">1000</span>)</span>
<span id="cb116-354"><a href="http://localhost:6592/#cb116-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-355"><a href="http://localhost:6592/#cb116-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-356"><a href="http://localhost:6592/#cb116-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-359"><a href="http://localhost:6592/#cb116-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-360"><a href="http://localhost:6592/#cb116-360" aria-hidden="true" tabindex="-1"></a><span class="co">#generate predictions from test set</span></span>
<span id="cb116-361"><a href="http://localhost:6592/#cb116-361" aria-hidden="true" tabindex="-1"></a>predictions2 <span class="ot">&lt;-</span> RFFinal <span class="sc">%&gt;%</span> <span class="fu">predict</span>(imputed_test)</span>
<span id="cb116-362"><a href="http://localhost:6592/#cb116-362" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate RMSLE</span></span>
<span id="cb116-363"><a href="http://localhost:6592/#cb116-363" aria-hidden="true" tabindex="-1"></a><span class="fu">rmsle</span>(predictions2<span class="sc">$</span>predictions, imputed_test<span class="sc">$</span>OnTimeGrad)</span>
<span id="cb116-364"><a href="http://localhost:6592/#cb116-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-365"><a href="http://localhost:6592/#cb116-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-366"><a href="http://localhost:6592/#cb116-366" aria-hidden="true" tabindex="-1"></a><span class="fu">#### iii) Support Vector Regression</span></span>
<span id="cb116-367"><a href="http://localhost:6592/#cb116-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-370"><a href="http://localhost:6592/#cb116-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-371"><a href="http://localhost:6592/#cb116-371" aria-hidden="true" tabindex="-1"></a><span class="co">#fit final model</span></span>
<span id="cb116-372"><a href="http://localhost:6592/#cb116-372" aria-hidden="true" tabindex="-1"></a>SVFinal <span class="ot">&lt;-</span> <span class="fu">svm</span>(OnTimeGrad <span class="sc">~</span> ., <span class="at">cost =</span> .<span class="dv">1052632</span>, <span class="at">data=</span>imputed_test)</span>
<span id="cb116-373"><a href="http://localhost:6592/#cb116-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-374"><a href="http://localhost:6592/#cb116-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-377"><a href="http://localhost:6592/#cb116-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-378"><a href="http://localhost:6592/#cb116-378" aria-hidden="true" tabindex="-1"></a><span class="co">#generate predictions from test set</span></span>
<span id="cb116-379"><a href="http://localhost:6592/#cb116-379" aria-hidden="true" tabindex="-1"></a>predictions3 <span class="ot">&lt;-</span> SVFinal <span class="sc">%&gt;%</span> <span class="fu">predict</span>(imputed_test)</span>
<span id="cb116-380"><a href="http://localhost:6592/#cb116-380" aria-hidden="true" tabindex="-1"></a>predictions3 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(predictions3)</span>
<span id="cb116-381"><a href="http://localhost:6592/#cb116-381" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate RMSLE</span></span>
<span id="cb116-382"><a href="http://localhost:6592/#cb116-382" aria-hidden="true" tabindex="-1"></a><span class="fu">rmsle</span>(predictions3<span class="sc">$</span>predictions, imputed_test<span class="sc">$</span>OnTimeGrad)</span>
<span id="cb116-383"><a href="http://localhost:6592/#cb116-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-384"><a href="http://localhost:6592/#cb116-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-385"><a href="http://localhost:6592/#cb116-385" aria-hidden="true" tabindex="-1"></a>With an RMSLE of .37, the lasso regression model should be the best fit for predicting the factors that contribute to on-time graduation of university undergraduates. Although the RMSE values of each model were quite close, using the RMSLE metric appears to help differentiate among them, as these values were much further from one another. Lasso regression is also a good choice because, unlike random forest or support vector regression, it is not a "black box" model and is easily explainable mathematically. The lasso model also seems to offer a good compromise between bias and variance, because the flexibility of having a tuning parameter and the fact that it penalizes having a large number of variables minimizes overfitting, while having a good size training set helps minimize underfitting.</span>
<span id="cb116-386"><a href="http://localhost:6592/#cb116-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-389"><a href="http://localhost:6592/#cb116-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-390"><a href="http://localhost:6592/#cb116-390" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate variable importance from final lasso model</span></span>
<span id="cb116-391"><a href="http://localhost:6592/#cb116-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-392"><a href="http://localhost:6592/#cb116-392" aria-hidden="true" tabindex="-1"></a>finaldata <span class="ot">&lt;-</span> <span class="fu">subset</span>(imputed_test, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(ID,Name)) </span>
<span id="cb116-393"><a href="http://localhost:6592/#cb116-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-394"><a href="http://localhost:6592/#cb116-394" aria-hidden="true" tabindex="-1"></a><span class="co">#create outcome variable object</span></span>
<span id="cb116-395"><a href="http://localhost:6592/#cb116-395" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> finaldata<span class="sc">$</span>OnTimeGrad</span>
<span id="cb116-396"><a href="http://localhost:6592/#cb116-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-397"><a href="http://localhost:6592/#cb116-397" aria-hidden="true" tabindex="-1"></a><span class="co">#create predictor variables object</span></span>
<span id="cb116-398"><a href="http://localhost:6592/#cb116-398" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(OnTimeGrad<span class="sc">~</span>., finaldata)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb116-399"><a href="http://localhost:6592/#cb116-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-400"><a href="http://localhost:6592/#cb116-400" aria-hidden="true" tabindex="-1"></a><span class="co">#fit final model</span></span>
<span id="cb116-401"><a href="http://localhost:6592/#cb116-401" aria-hidden="true" tabindex="-1"></a>LRFinal <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">1</span>, <span class="at">lambda=</span>.<span class="dv">1779</span>)</span>
<span id="cb116-402"><a href="http://localhost:6592/#cb116-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-403"><a href="http://localhost:6592/#cb116-403" aria-hidden="true" tabindex="-1"></a><span class="fu">vip</span>(LRFinal)</span>
<span id="cb116-404"><a href="http://localhost:6592/#cb116-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-405"><a href="http://localhost:6592/#cb116-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-406"><a href="http://localhost:6592/#cb116-406" aria-hidden="true" tabindex="-1"></a>The lasso regression model also allows for variable importance analysis, which is very helpful in this particular project because it shows which particular institutional characteristics have the greatest potential to influence on-time graduation, so universities with limited budgets could use the information to plan new services according to importance.</span>
<span id="cb116-407"><a href="http://localhost:6592/#cb116-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-408"><a href="http://localhost:6592/#cb116-408" aria-hidden="true" tabindex="-1"></a><span class="fu">## 7) Ethical Implications</span></span>
<span id="cb116-409"><a href="http://localhost:6592/#cb116-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-410"><a href="http://localhost:6592/#cb116-410" aria-hidden="true" tabindex="-1"></a>Since this predictive model is based on *institutional* characteristics, there is little possibility of incurring ethical issues in its use. Student-based models, on the other hand, could be fraught with potential bias or profiling based on misapplied assumptions about specific populations or demographic markers. Using data about institutional traits to predict student success targets in tandem with the input of substantively-informed decision-makers seems like an acceptable compromise between automation and fairness.</span>
<span id="cb116-411"><a href="http://localhost:6592/#cb116-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-412"><a href="http://localhost:6592/#cb116-412" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
<span id="cb116-413"><a href="http://localhost:6592/#cb116-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-414"><a href="http://localhost:6592/#cb116-414" aria-hidden="true" tabindex="-1"></a>Attiya, W. M., &amp; Shams, M. B. (2023). Predicting Student Retention in Higher Education Using Data Mining Techniques: A Literature Review. *2023 International Conference On Cyber Management And Engineering (CyMaEn), Cyber Management And Engineering (CyMaEn), 2023 International Conference On*, 171--177. <span class="ot">&lt;https://doi.org/10.1109/CyMaEn57228.2023.10051056&gt;</span></span>
<span id="cb116-415"><a href="http://localhost:6592/#cb116-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-416"><a href="http://localhost:6592/#cb116-416" aria-hidden="true" tabindex="-1"></a>Cardona, T., Cudney, E. A., Hoerl, R., &amp; Snyder, J. (2020). Data Mining and Machine Learning Retention Models in Higher Education. *Journal of College Student Retention: Research, Theory &amp; Practice*, *25*(1), 51--75. <span class="ot">&lt;https://doi.org/10.1177/1521025120964920&gt;</span></span>
<span id="cb116-417"><a href="http://localhost:6592/#cb116-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-418"><a href="http://localhost:6592/#cb116-418" aria-hidden="true" tabindex="-1"></a>Marsh, G. (2014). Institutional Characteristics and Student Retention in Public 4-Year Colleges and Universities. *Journal of College Student Retention: Research, Theory &amp; Practice*, *16*(1), 127--151. <span class="ot">&lt;https://doi.org/10.2190/CS.16.1.g&gt;</span></span>
<span id="cb116-419"><a href="http://localhost:6592/#cb116-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-420"><a href="http://localhost:6592/#cb116-420" aria-hidden="true" tabindex="-1"></a>Medved, S. (2022, April 27). *Why College Students May Not Graduate in Four Years---The Bottom Line UCSB*. <span class="ot">&lt;https://thebottomline.as.ucsb.edu/2022/04/why-college-students-may-not-graduate-in-four-years&gt;</span></span>
<span id="cb116-421"><a href="http://localhost:6592/#cb116-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-422"><a href="http://localhost:6592/#cb116-422" aria-hidden="true" tabindex="-1"></a>Moore, C., &amp; Shulock, N. (2009). *Student Progress Toward Degree Completion: Lessons From the Research Literature*. California State University Sacramento Institute for Higher Education Leadership &amp; Policy.</span>
<span id="cb116-423"><a href="http://localhost:6592/#cb116-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-424"><a href="http://localhost:6592/#cb116-424" aria-hidden="true" tabindex="-1"></a>Oseguera, L. (2005). Four and Six-Year Baccalaureate Degree Completion by Institutional Characteristics and Racial/Ethnic Groups. *Journal of College Student Retention: Research, Theory &amp; Practice*, *7*(1/2), 19--59. <span class="ot">&lt;https://doi.org/10.2190/E1TU-AW8J-5FYA-GLPW&gt;</span></span>
<span id="cb116-425"><a href="http://localhost:6592/#cb116-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-426"><a href="http://localhost:6592/#cb116-426" aria-hidden="true" tabindex="-1"></a>U.S. Department of Education. (2018). *National Center for Education Statistics, Integrated Postsecondary Education Data System (IPEDS), \[data set\]*. <span class="ot">&lt;https://nces.ed.gov/ipeds/datacenter/InstitutionByName.aspx?goToReportId=1&gt;</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<div class="modal__dialog micromodal-slide" id="quarto-log-error-modal" aria-hidden="true">
  <div class="modal__overlay" tabindex="2" data-micromodal-close="">
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="quarto-log-error-modal-title">
      <header class="modal__header">
        <h2 class="modal__title" id="quarto-log-error-modal-title">
          <i class="bi bi-exclamation-circle"></i>Error
        </h2>
        <button class="modal__close" aria-label="Close modal" data-micromodal-close=""></button>
      </header>
      <div class="modal__content" id="quarto-log-error-modal-content">
        <pre tabindex="1" id="quarto-log-error-display"></pre>
      </div>
      <footer class="modal__footer">
      </footer>
    </div>
  </div>
</div>
<style type="text/css">
#quarto-log-error-modal .modal__overlay {
  z-index: 5000;
}
#quarto-log-error-modal-content {
  border: 1px solid #dee2e6;
  overflow-y: auto;
}
#quarto-log-error-display {
  min-height: 100px;
  padding: 8px;
  margin-bottom: 0;
  font-family: monospace;
}
#quarto-log-error-display:focus {
  outline: none;
}
.modal__dialog {
  font-size: 16px;
}
.modal__overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.4);
  display: flex;
  justify-content: center;
  align-items: center;
}
.modal__container {
  position: fixed;
  top: 80px;
  background-color: #fff;
  padding: 15px;
  padding-top: 10px;
  min-width: 500px;
  max-width: 90%;
  max-height: 90vh;
  border-radius: 4px;
  overflow-y: auto;
  box-sizing: border-box;
}
.modal__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.modal__title {
  margin-top: 0;
  margin-bottom: 0;
  font-weight: 600;
  border-bottom: none;
  padding-bottom: 10px;
  font-size: 20px;
  color: rgb(191,71,65);
  line-height: 1.25;
  box-sizing: border-box;
}
.modal__title .bi {
  margin-right: 7px;
}
.modal__close {
  background: transparent;
  border: 0;
  margin-bottom: 10px;
}
.modal__header .modal__close:before { content: "\2715"; }
.modal__content {
  margin-top: 0;
  margin-bottom: 0;
}
@keyframes mmfadeIn {
    from { opacity: 0; }
      to { opacity: 1; }
}
@keyframes mmfadeOut {
    from { opacity: 1; }
      to { opacity: 0; }
}
@keyframes mmslideIn {
  from { transform: translateY(15%); }
    to { transform: translateY(0); }
}
@keyframes mmslideOut {
    from { transform: translateY(0); }
    to { transform: translateY(-10%); }
}
.micromodal-slide {
  display: none;
}
.micromodal-slide.is-open {
  display: block;
}
.micromodal-slide[aria-hidden="false"] .modal__overlay {
  animation: mmfadeIn .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="false"] .modal__container {
  animation: mmslideIn .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__overlay {
  animation: mmfadeOut .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__container {
  animation: mmslideOut .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide .modal__container,
.micromodal-slide .modal__overlay {
  will-change: transform;
} 
</style>
<script type="text/javascript">
  window.backupDefine = window.define; window.define = undefined;
  /*  ansi_up.js
   *  author : Dru Nelson
   *  license : MIT
   *  http://github.com/drudru/ansi_up
   */
   (function (root, factory) {
      if (typeof define === 'function' && define.amd) {
          // AMD. Register as an anonymous module.
          define(['exports'], factory);
      } else if (typeof exports === 'object' && typeof exports.nodeName !== 'string') {
          // CommonJS
          factory(exports);
      } else {
          // Browser globals
          var exp = {};
          factory(exp);
          root.AnsiUp = exp.default;
      }
  }(this, function (exports) {
  "use strict";
  var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
      if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
      return cooked;
  };
  var PacketKind;
  (function (PacketKind) {
      PacketKind[PacketKind["EOS"] = 0] = "EOS";
      PacketKind[PacketKind["Text"] = 1] = "Text";
      PacketKind[PacketKind["Incomplete"] = 2] = "Incomplete";
      PacketKind[PacketKind["ESC"] = 3] = "ESC";
      PacketKind[PacketKind["Unknown"] = 4] = "Unknown";
      PacketKind[PacketKind["SGR"] = 5] = "SGR";
      PacketKind[PacketKind["OSCURL"] = 6] = "OSCURL";
  })(PacketKind || (PacketKind = {}));
  var AnsiUp = (function () {
      function AnsiUp() {
          this.VERSION = "5.1.0";
          this.setup_palettes();
          this._use_classes = false;
          this.bold = false;
          this.italic = false;
          this.underline = false;
          this.fg = this.bg = null;
          this._buffer = '';
          this._url_whitelist = { 'http': 1, 'https': 1 };
      }
      Object.defineProperty(AnsiUp.prototype, "use_classes", {
          get: function () {
              return this._use_classes;
          },
          set: function (arg) {
              this._use_classes = arg;
          },
          enumerable: false,
          configurable: true
      });
      Object.defineProperty(AnsiUp.prototype, "url_whitelist", {
          get: function () {
              return this._url_whitelist;
          },
          set: function (arg) {
              this._url_whitelist = arg;
          },
          enumerable: false,
          configurable: true
      });
      AnsiUp.prototype.setup_palettes = function () {
          var _this = this;
          this.ansi_colors =
              [
                  [
                      { rgb: [0, 0, 0], class_name: "ansi-black" },
                      { rgb: [187, 0, 0], class_name: "ansi-red" },
                      { rgb: [0, 187, 0], class_name: "ansi-green" },
                      { rgb: [187, 187, 0], class_name: "ansi-yellow" },
                      { rgb: [0, 0, 187], class_name: "ansi-blue" },
                      { rgb: [187, 0, 187], class_name: "ansi-magenta" },
                      { rgb: [0, 187, 187], class_name: "ansi-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-white" }
                  ],
                  [
                      { rgb: [85, 85, 85], class_name: "ansi-bright-black" },
                      { rgb: [255, 85, 85], class_name: "ansi-bright-red" },
                      { rgb: [0, 255, 0], class_name: "ansi-bright-green" },
                      { rgb: [255, 255, 85], class_name: "ansi-bright-yellow" },
                      { rgb: [85, 85, 255], class_name: "ansi-bright-blue" },
                      { rgb: [255, 85, 255], class_name: "ansi-bright-magenta" },
                      { rgb: [85, 255, 255], class_name: "ansi-bright-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-bright-white" }
                  ]
              ];
          this.palette_256 = [];
          this.ansi_colors.forEach(function (palette) {
              palette.forEach(function (rec) {
                  _this.palette_256.push(rec);
              });
          });
          var levels = [0, 95, 135, 175, 215, 255];
          for (var r = 0; r < 6; ++r) {
              for (var g = 0; g < 6; ++g) {
                  for (var b = 0; b < 6; ++b) {
                      var col = { rgb: [levels[r], levels[g], levels[b]], class_name: 'truecolor' };
                      this.palette_256.push(col);
                  }
              }
          }
          var grey_level = 8;
          for (var i = 0; i < 24; ++i, grey_level += 10) {
              var gry = { rgb: [grey_level, grey_level, grey_level], class_name: 'truecolor' };
              this.palette_256.push(gry);
          }
      };
      AnsiUp.prototype.escape_txt_for_html = function (txt) {
          return txt.replace(/[&<>"']/gm, function (str) {
              if (str === "&")
                  return "&amp;";
              if (str === "<")
                  return "&lt;";
              if (str === ">")
                  return "&gt;";
              if (str === "\"")
                  return "&quot;";
              if (str === "'")
                  return "&#x27;";
          });
      };
      AnsiUp.prototype.append_buffer = function (txt) {
          var str = this._buffer + txt;
          this._buffer = str;
      };
      AnsiUp.prototype.get_next_packet = function () {
          var pkt = {
              kind: PacketKind.EOS,
              text: '',
              url: ''
          };
          var len = this._buffer.length;
          if (len == 0)
              return pkt;
          var pos = this._buffer.indexOf("\x1B");
          if (pos == -1) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer;
              this._buffer = '';
              return pkt;
          }
          if (pos > 0) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer.slice(0, pos);
              this._buffer = this._buffer.slice(pos);
              return pkt;
          }
          if (pos == 0) {
              if (len == 1) {
                  pkt.kind = PacketKind.Incomplete;
                  return pkt;
              }
              var next_char = this._buffer.charAt(1);
              if ((next_char != '[') && (next_char != ']')) {
                  pkt.kind = PacketKind.ESC;
                  pkt.text = this._buffer.slice(0, 1);
                  this._buffer = this._buffer.slice(1);
                  return pkt;
              }
              if (next_char == '[') {
                  if (!this._csi_regex) {
                      this._csi_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \u001B[                      # CSI\n                          ([<-?]?)              # private-mode char\n                          ([d;]*)                    # any digits or semicolons\n                          ([ -/]?               # an intermediate modifier\n                          [@-~])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \u001B[                      # CSI\n                          [ -~]*                # anything legal\n                          ([\0-\u001F:])              # anything illegal\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \\x1b\\[                      # CSI\n                          ([\\x3c-\\x3f]?)              # private-mode char\n                          ([\\d;]*)                    # any digits or semicolons\n                          ([\\x20-\\x2f]?               # an intermediate modifier\n                          [\\x40-\\x7e])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \\x1b\\[                      # CSI\n                          [\\x20-\\x7e]*                # anything legal\n                          ([\\x00-\\x1f:])              # anything illegal\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._csi_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if (match[4]) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if ((match[1] != '') || (match[3] != 'm'))
                      pkt.kind = PacketKind.Unknown;
                  else
                      pkt.kind = PacketKind.SGR;
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
              if (next_char == ']') {
                  if (len < 4) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if ((this._buffer.charAt(2) != '8')
                      || (this._buffer.charAt(3) != ';')) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if (!this._osc_st) {
                      this._osc_st = rgxG(__makeTemplateObject(["\n                        (?:                         # legal sequence\n                          (\u001B\\)                    # ESC                           |                           # alternate\n                          (\u0007)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\0-\u0006]                 # anything illegal\n                          |                           # alternate\n                          [\b-\u001A]                 # anything illegal\n                          |                           # alternate\n                          [\u001C-\u001F]                 # anything illegal\n                        )\n                    "], ["\n                        (?:                         # legal sequence\n                          (\\x1b\\\\)                    # ESC \\\n                          |                           # alternate\n                          (\\x07)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\\x00-\\x06]                 # anything illegal\n                          |                           # alternate\n                          [\\x08-\\x1a]                 # anything illegal\n                          |                           # alternate\n                          [\\x1c-\\x1f]                 # anything illegal\n                        )\n                    "]));
                  }
                  this._osc_st.lastIndex = 0;
                  {
                      var match_1 = this._osc_st.exec(this._buffer);
                      if (match_1 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_1[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  {
                      var match_2 = this._osc_st.exec(this._buffer);
                      if (match_2 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_2[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  if (!this._osc_regex) {
                      this._osc_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                        \u001B]8;                    # OSC Hyperlink\n                        [ -:<-~]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([!-~]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                        ([ -~]+)              # TEXT capture\n                        \u001B]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                        \\x1b\\]8;                    # OSC Hyperlink\n                        [\\x20-\\x3a\\x3c-\\x7e]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([\\x21-\\x7e]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                        ([\\x20-\\x7e]+)              # TEXT capture\n                        \\x1b\\]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._osc_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  pkt.kind = PacketKind.OSCURL;
                  pkt.url = match[1];
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
          }
      };
      AnsiUp.prototype.ansi_to_html = function (txt) {
          this.append_buffer(txt);
          var blocks = [];
          while (true) {
              var packet = this.get_next_packet();
              if ((packet.kind == PacketKind.EOS)
                  || (packet.kind == PacketKind.Incomplete))
                  break;
              if ((packet.kind == PacketKind.ESC)
                  || (packet.kind == PacketKind.Unknown))
                  continue;
              if (packet.kind == PacketKind.Text)
                  blocks.push(this.transform_to_html(this.with_state(packet)));
              else if (packet.kind == PacketKind.SGR)
                  this.process_ansi(packet);
              else if (packet.kind == PacketKind.OSCURL)
                  blocks.push(this.process_hyperlink(packet));
          }
          return blocks.join("");
      };
      AnsiUp.prototype.with_state = function (pkt) {
          return { bold: this.bold, italic: this.italic, underline: this.underline, fg: this.fg, bg: this.bg, text: pkt.text };
      };
      AnsiUp.prototype.process_ansi = function (pkt) {
          var sgr_cmds = pkt.text.split(';');
          while (sgr_cmds.length > 0) {
              var sgr_cmd_str = sgr_cmds.shift();
              var num = parseInt(sgr_cmd_str, 10);
              if (isNaN(num) || num === 0) {
                  this.fg = this.bg = null;
                  this.bold = false;
                  this.italic = false;
                  this.underline = false;
              }
              else if (num === 1) {
                  this.bold = true;
              }
              else if (num === 3) {
                  this.italic = true;
              }
              else if (num === 4) {
                  this.underline = true;
              }
              else if (num === 22) {
                  this.bold = false;
              }
              else if (num === 23) {
                  this.italic = false;
              }
              else if (num === 24) {
                  this.underline = false;
              }
              else if (num === 39) {
                  this.fg = null;
              }
              else if (num === 49) {
                  this.bg = null;
              }
              else if ((num >= 30) && (num < 38)) {
                  this.fg = this.ansi_colors[0][(num - 30)];
              }
              else if ((num >= 40) && (num < 48)) {
                  this.bg = this.ansi_colors[0][(num - 40)];
              }
              else if ((num >= 90) && (num < 98)) {
                  this.fg = this.ansi_colors[1][(num - 90)];
              }
              else if ((num >= 100) && (num < 108)) {
                  this.bg = this.ansi_colors[1][(num - 100)];
              }
              else if (num === 38 || num === 48) {
                  if (sgr_cmds.length > 0) {
                      var is_foreground = (num === 38);
                      var mode_cmd = sgr_cmds.shift();
                      if (mode_cmd === '5' && sgr_cmds.length > 0) {
                          var palette_index = parseInt(sgr_cmds.shift(), 10);
                          if (palette_index >= 0 && palette_index <= 255) {
                              if (is_foreground)
                                  this.fg = this.palette_256[palette_index];
                              else
                                  this.bg = this.palette_256[palette_index];
                          }
                      }
                      if (mode_cmd === '2' && sgr_cmds.length > 2) {
                          var r = parseInt(sgr_cmds.shift(), 10);
                          var g = parseInt(sgr_cmds.shift(), 10);
                          var b = parseInt(sgr_cmds.shift(), 10);
                          if ((r >= 0 && r <= 255) && (g >= 0 && g <= 255) && (b >= 0 && b <= 255)) {
                              var c = { rgb: [r, g, b], class_name: 'truecolor' };
                              if (is_foreground)
                                  this.fg = c;
                              else
                                  this.bg = c;
                          }
                      }
                  }
              }
          }
      };
      AnsiUp.prototype.transform_to_html = function (fragment) {
          var txt = fragment.text;
          if (txt.length === 0)
              return txt;
          txt = this.escape_txt_for_html(txt);
          if (!fragment.bold && !fragment.italic && !fragment.underline && fragment.fg === null && fragment.bg === null)
              return txt;
          var styles = [];
          var classes = [];
          var fg = fragment.fg;
          var bg = fragment.bg;
          if (fragment.bold)
              styles.push('font-weight:bold');
          if (fragment.italic)
              styles.push('font-style:italic');
          if (fragment.underline)
              styles.push('text-decoration:underline');
          if (!this._use_classes) {
              if (fg)
                  styles.push("color:rgb(" + fg.rgb.join(',') + ")");
              if (bg)
                  styles.push("background-color:rgb(" + bg.rgb + ")");
          }
          else {
              if (fg) {
                  if (fg.class_name !== 'truecolor') {
                      classes.push(fg.class_name + "-fg");
                  }
                  else {
                      styles.push("color:rgb(" + fg.rgb.join(',') + ")");
                  }
              }
              if (bg) {
                  if (bg.class_name !== 'truecolor') {
                      classes.push(bg.class_name + "-bg");
                  }
                  else {
                      styles.push("background-color:rgb(" + bg.rgb.join(',') + ")");
                  }
              }
          }
          var class_string = '';
          var style_string = '';
          if (classes.length)
              class_string = " class=\"" + classes.join(' ') + "\"";
          if (styles.length)
              style_string = " style=\"" + styles.join(';') + "\"";
          return "<span" + style_string + class_string + ">" + txt + "</span>";
      };
      ;
      AnsiUp.prototype.process_hyperlink = function (pkt) {
          var parts = pkt.url.split(':');
          if (parts.length < 1)
              return '';
          if (!this._url_whitelist[parts[0]])
              return '';
          var result = "<a href=\"" + this.escape_txt_for_html(pkt.url) + "\">" + this.escape_txt_for_html(pkt.text) + "</a>";
          return result;
      };
      return AnsiUp;
  }());
  function rgx(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2);
  }
  function rgxG(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2, 'g');
  }
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.default = AnsiUp;
  }));
  // micromodal: https://github.com/Ghosh/micromodal
  !function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).MicroModal=t()}(this,(function(){"use strict";function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var n,i,a,r,s,l=(n=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],i=function(){function o(e){var n=e.targetModal,i=e.triggers,a=void 0===i?[]:i,r=e.onShow,s=void 0===r?function(){}:r,l=e.onClose,c=void 0===l?function(){}:l,d=e.openTrigger,u=void 0===d?"data-micromodal-trigger":d,f=e.closeTrigger,h=void 0===f?"data-micromodal-close":f,v=e.openClass,g=void 0===v?"is-open":v,m=e.disableScroll,b=void 0!==m&&m,y=e.disableFocus,p=void 0!==y&&y,w=e.awaitCloseAnimation,E=void 0!==w&&w,k=e.awaitOpenAnimation,M=void 0!==k&&k,A=e.debugMode,C=void 0!==A&&A;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.modal=document.getElementById(n),this.config={debugMode:C,disableScroll:b,openTrigger:u,closeTrigger:h,openClass:g,onShow:s,onClose:c,awaitCloseAnimation:E,awaitOpenAnimation:M,disableFocus:p},a.length>0&&this.registerTriggers.apply(this,t(a)),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}var i,a,r;return i=o,(a=[{key:"registerTriggers",value:function(){for(var e=this,t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];o.filter(Boolean).forEach((function(t){t.addEventListener("click",(function(t){return e.showModal(t)}))}))}},{key:"showModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.scrollBehaviour("disable"),this.addEventListeners(),this.config.awaitOpenAnimation){var o=function t(){e.modal.removeEventListener("animationend",t,!1),e.setFocusToFirstNode()};this.modal.addEventListener("animationend",o,!1)}else this.setFocusToFirstNode();this.config.onShow(this.modal,this.activeElement,t)}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.modal;if(this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,e),this.config.awaitCloseAnimation){var o=this.config.openClass;this.modal.addEventListener("animationend",(function e(){t.classList.remove(o),t.removeEventListener("animationend",e,!1)}),!1)}else t.classList.remove(this.config.openClass)}},{key:"closeModalById",value:function(e){this.modal=document.getElementById(e),this.modal&&this.closeModal()}},{key:"scrollBehaviour",value:function(e){if(this.config.disableScroll){var t=document.querySelector("body");switch(e){case"enable":Object.assign(t.style,{overflow:""});break;case"disable":Object.assign(t.style,{overflow:"hidden"})}}}},{key:"addEventListeners",value:function(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function(e){(e.target.hasAttribute(this.config.closeTrigger)||e.target.parentNode.hasAttribute(this.config.closeTrigger))&&(e.preventDefault(),e.stopPropagation(),this.closeModal(e))}},{key:"onKeydown",value:function(e){27===e.keyCode&&this.closeModal(e),9===e.keyCode&&this.retainFocus(e)}},{key:"getFocusableNodes",value:function(){var e=this.modal.querySelectorAll(n);return Array.apply(void 0,t(e))}},{key:"setFocusToFirstNode",value:function(){var e=this;if(!this.config.disableFocus){var t=this.getFocusableNodes();if(0!==t.length){var o=t.filter((function(t){return!t.hasAttribute(e.config.closeTrigger)}));o.length>0&&o[0].focus(),0===o.length&&t[0].focus()}}}},{key:"retainFocus",value:function(e){var t=this.getFocusableNodes();if(0!==t.length)if(t=t.filter((function(e){return null!==e.offsetParent})),this.modal.contains(document.activeElement)){var o=t.indexOf(document.activeElement);e.shiftKey&&0===o&&(t[t.length-1].focus(),e.preventDefault()),!e.shiftKey&&t.length>0&&o===t.length-1&&(t[0].focus(),e.preventDefault())}else t[0].focus()}}])&&e(i.prototype,a),r&&e(i,r),o}(),a=null,r=function(e){if(!document.getElementById(e))return console.warn("MicroModal: ❗Seems like you have missed %c'".concat(e,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(e,'"></div>')),!1},s=function(e,t){if(function(e){e.length<=0&&(console.warn("MicroModal: ❗Please specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>'))}(e),!t)return!0;for(var o in t)r(o);return!0},{init:function(e){var o=Object.assign({},{openTrigger:"data-micromodal-trigger"},e),n=t(document.querySelectorAll("[".concat(o.openTrigger,"]"))),r=function(e,t){var o=[];return e.forEach((function(e){var n=e.attributes[t].value;void 0===o[n]&&(o[n]=[]),o[n].push(e)})),o}(n,o.openTrigger);if(!0!==o.debugMode||!1!==s(n,r))for(var l in r){var c=r[l];o.targetModal=l,o.triggers=t(c),a=new i(o)}},show:function(e,t){var o=t||{};o.targetModal=e,!0===o.debugMode&&!1===r(e)||(a&&a.removeEventListeners(),(a=new i(o)).showModal())},close:function(e){e?a.closeModalById(e):a.closeModal()}});return"undefined"!=typeof window&&(window.MicroModal=l),l}));  
  window.define = window.backupDefine; window.backupDefine = undefined;
  </script>
<script type="text/javascript">
  (function () {
    // forward keydown events so shortcuts can work in vscode, see:
    // https://github.com/microsoft/vscode/issues/65452#issuecomment-586485815
    if (window.parent.postMessage) {
      window.document.addEventListener('keydown', e => {
        const event = {
          type: "keydown",
          data: {
            altKey: e.altKey,
            code: e.code,
            ctrlKey: e.ctrlKey,
            isComposing: e.isComposing,
            key: e.key,
            location: e.location,
            metaKey: e.metaKey,
            repeat: e.repeat,
            shiftKey: e.shiftKey
          }
        };
        window.parent.postMessage(event, '*');
      });
    }
    // listen for execCommand messages
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-exec-command") {
        window.document.execCommand(event.data.data);
      } 
    }, true);
    const logEntries = new Array(1000);
    logEntries.offset = 0;
    function recordLogEntry(entry) {
      logEntries[logEntries.offset++] = entry;
      logEntries.offset %= logEntries.length;
    }
    function getLogEntry(i) { // backwards, 0 is most recent
        return logEntries[(logEntries.offset - 1 - i + logEntries.length) % logEntries.length];
    }
    const protocol = window.location.protocol === "https:" ? "wss:" : "ws:";
    let path = window.location.pathname;
    if (!/\/$/.test(path)) path += "/";
    const devServerSocket = new WebSocket(protocol + "//" + window.location.host + path);
    let reloadPage = true;
    addEventListener("beforeunload", () => {
      // don't reload page in case of navigation events
      reloadPage = false;
    })
    devServerSocket.onopen = () => {
      console.log('Socket connection open. Listening for events.');
      // if the socket closes for any reason (e.g. this occurs in electron apps
      // when the computer suspends) then reload to reestablish the connection 
      devServerSocket.onclose = () => {
        if (reloadPage) {
          console.log('Socket connection closed. Reloading.');
          window.location.reload(true);
        }
      }
    };
    // append for errors that occur within the error window
    let lastError = 0;
    const kErrorWindow = 2500;
    function showError(msg) {
      const ansiUp = new AnsiUp
      const html = ansiUp.ansi_to_html(msg.trim());
      const display = document.getElementById("quarto-log-error-display");
      if (display.innerHTML && ((Date.now() - lastError) < kErrorWindow)) {
        display.innerHTML = display.innerHTML + "<br/>" +  html;
      } else {
        display.innerHTML = html
      }
      lastError = Date.now()
      MicroModal.show('quarto-log-error-modal', {
        awaitCloseAnimation: true,
        onClose: () => { display.innerHTML = ""; }
      });
      // post message to parent indicating we had an error
      if (window.parent.postMessage) {
        window.parent.postMessage({
          type: "error",
          msg: msg,
        }, "*");
      }
    }
    // see if there is already an error to show
    const renderError = document.getElementById("quarto-render-error");
    if (renderError) {
      showError(renderError.innerHTML.trim());
    }
    const normalizeTarget = (target) => {
      return target.replace(/\/index\.html/, "/")
    };
    devServerSocket.onmessage = (msg) => {
      if (msg.data.startsWith('reload')) {
        let target = normalizeTarget(msg.data.replace(/^reload/, ""));
        // prepend proxy path to target if we have one
        if (target) {
          const pathPrefix = 
            window.location.pathname.match(/^.*?\/p\/\w+\//) ||
            window.location.pathname.match(/^.*?\/user\/[\w\d]+\/proxy\/\d+\//);
          if (pathPrefix) {
            target = pathPrefix + target.slice(1);
          }
        }
        if (target && (target !== normalizeTarget(window.location.pathname))) {
          window.location.replace(target);
        } else {
          window.location.reload(true);
        }
      } else if (msg.data.startsWith('log:')) {
        const ansiUp = new AnsiUp
        const log = JSON.parse(msg.data.substr(4));
        recordLogEntry(log);
        if (log.levelName === "ERROR") {
          showError(log.msgFormatted)
        } else {
          // see if there is a knitr error to report
          const kExecutionHalted = "Execution halted";
          if (log.msg.indexOf(kExecutionHalted) !== -1) {
            // scan backwards for beginning of error
            const errorEntries = [getLogEntry(0).msgFormatted];
            for (let i=1; i<logEntries.length; i++) {
              const logEntry = getLogEntry(i);
              if (logEntry) {
                errorEntries.unshift(logEntry.msgFormatted);
                if (logEntry.msg.indexOf("Quitting from lines") !== -1) {
                  showError(errorEntries.join(""));
                  break;
                } else if (logEntry.msg.indexOf(kExecutionHalted) !== -1) {
                  break;
                }
              } else {
                break;
              }
            }
          }
        }
      }
    };
  })();
</script>

<script type="text/javascript">
  if (window.parent.postMessage) {
    // wait for message providing confirmation we are in a devhost
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-init") {
        window.quartoDevhost = {
          openInputFile: function (line, column, highlight) {
            window.parent.postMessage({
              type: "openfile",
              file: "C:\Users\Karen Detter\Desktop\PROJECTS\MachineLearningAnalysisSpring2023.qmd",
              line: line,
              column: column,
              highlight: highlight
            }, event.origin);
          }
        };
      } else if (event.data.type === "goback") {
        window.history.back()
      } else if (event.data.type === "goforward") {
        window.history.forward()
      }
    }, true);
    // notify host of navigation (e.g. for 'pop out' command)
    window.parent.postMessage({
      type: "navigate",
      href: window.location.href,
      file: "C:\Users\Karen Detter\Desktop\PROJECTS\MachineLearningAnalysisSpring2023.qmd"
    }, "*");
  }
</script>
</body></html>